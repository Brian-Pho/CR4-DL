{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/textbooks/deep-learning-with-python/",
    "result": {"data":{"markdownRemark":{"html":"<blockquote class=\"blockquote\">\n  <p>Computer science is no more about computers than astronomy is about telescopes.</p>\n  <p class=\"blockquote-footer\">Unknown</p>\n</blockquote>\n<h1 id=\"part-i-fundamentals-of-deep-learning\" style=\"position:relative;\"><a href=\"#part-i-fundamentals-of-deep-learning\" aria-label=\"part i fundamentals of deep learning permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part I: Fundamentals of Deep Learning</h1>\n<h2 id=\"chapter-1-what-is-deep-learning\" style=\"position:relative;\"><a href=\"#chapter-1-what-is-deep-learning\" aria-label=\"chapter 1 what is deep learning permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 1: What is deep learning?</h2>\n<ul>\n<li>Repository with author’s code\n<ul>\n<li><a href=\"https://github.com/fchollet/deep-learning-with-python-notebooks\">https://github.com/fchollet/deep-learning-with-python-notebooks</a></li>\n</ul>\n</li>\n<li>Download my Google Colaboratory code\n<ul>\n<li><a href=\"/CR4-DL/63989355fa34043a73879386cb944cd3/google-colaboratory.ipynb\">Google Colaboratory/Jupyter Notebook</a></li>\n<li><a href=\"/CR4-DL/b4c47523bb2b3aec23a2ae9c3c7256d9/raw-python.py\">Raw Python</a></li>\n</ul>\n</li>\n<li>Deep learning → Machine learning → Artificial intelligence</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/d3736c4d7fd8c155c159b0f80784e64f/c83ae/figure1-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzElEQVQY03WNS46DMBAFuf/dJiukhI35GJCMAbsbW9CmG0eTRTRSJrWsp9IrzpTmZTn23U7TsixN07RtO9kphiAiRMTM+QvFyTwMI3gYxxERlVJd262rc84hgDEmxphzvq7rnzjnfKYkzESEL7Zt2xDlz+G7vF68TfE5fPv5lIWIOOf2fZ+tRcRaqV733vsYAhEdxyEi3vsQIhEBACKGEAAgxljM1upOe+97rfk8x2EwxqSU3LoigHOemetaPapfHvd7WZZVVf3cblrrJ0oTWEcplWJ3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 1.2\"\n        title=\"Figure 1.2\"\n        src=\"/CR4-DL/static/d3736c4d7fd8c155c159b0f80784e64f/00d43/figure1-2.png\"\n        srcset=\"/CR4-DL/static/d3736c4d7fd8c155c159b0f80784e64f/63868/figure1-2.png 250w,\n/CR4-DL/static/d3736c4d7fd8c155c159b0f80784e64f/0b533/figure1-2.png 500w,\n/CR4-DL/static/d3736c4d7fd8c155c159b0f80784e64f/00d43/figure1-2.png 1000w,\n/CR4-DL/static/d3736c4d7fd8c155c159b0f80784e64f/c83ae/figure1-2.png 1180w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><em>Representations</em>: different ways to look at data; to represent or encode the data.</li>\n<li><em>Learning</em>: in machine learning, describes the automatic search for better representations.</li>\n<li><em>Hypothesis space</em>: the set of possible operations that tests whether the operation on the input data generates the correct output.</li>\n<li>E.g. Coordinate changes, translations, linear projections.</li>\n<li>The high level steps of machine learning\n<ul>\n<li>Search for useful representations of some input data</li>\n<li>Search within a predefined space of possibilities (hypothesis space)</li>\n<li>Search using guidance from a feedback signal</li>\n</ul>\n</li>\n<li><em>Deep learning</em>: the idea of successive layers of representations.</li>\n<li>You can think of a deep network as a multistage information-distillation operation, where information goes through successive filters and comes out increasingly purified.</li>\n<li>However, don’t mistake deep learning for deeper understanding.</li>\n<li>The term “neural network” comes from biology but the relationship to the brain isn’t there.</li>\n<li>Don’t link artificial neural networks with biological neural networks.</li>\n<li><em>Loss function</em>: the error between the actual output of network and the expected output.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/d563a6da5ba7d94aaff35d79b6f1f8f5/913a1/figure1-9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDElEQVQoz42Q3Y6CMBCFff+XYy+MyZqolNJSCxXaDi39YzZKYvZGw7k6k8w3OWcO+E8AIIRY1xX36TD0g1JK68nopzrOwYKb3S64l7KXPQB0nFNK67pu29YYswvW02SMcc5prdUwNIRorWeAXXDbtrSh0zh2nLOWkZowxqyxiLiV//KCJxxCQMSUkhCC1GSe521Ug2KMGW0+w5TGGLdtABgfD6M1Ii7L8nh57/1HWN4l59wY8w55vwvRdbRp4BXhW2znnPcerPXehxByzsuyjONorS2lIGLOOcZYStlMzjmlFNNTh/eZdV1LKSEEpdTtdmOMbXV6Kauqulwup9Pp93w+Ho/X67X6qWpC/gCB0EK6tNqGFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 1.9\"\n        title=\"Figure 1.9\"\n        src=\"/CR4-DL/static/d563a6da5ba7d94aaff35d79b6f1f8f5/00d43/figure1-9.png\"\n        srcset=\"/CR4-DL/static/d563a6da5ba7d94aaff35d79b6f1f8f5/63868/figure1-9.png 250w,\n/CR4-DL/static/d563a6da5ba7d94aaff35d79b6f1f8f5/0b533/figure1-9.png 500w,\n/CR4-DL/static/d563a6da5ba7d94aaff35d79b6f1f8f5/00d43/figure1-9.png 1000w,\n/CR4-DL/static/d563a6da5ba7d94aaff35d79b6f1f8f5/913a1/figure1-9.png 1476w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Other types of machine learning\n<ul>\n<li>Probabilistic modeling</li>\n<li>Support vector machines</li>\n<li>Decision trees and random forests</li>\n</ul>\n</li>\n<li>Deep learning is different due to\n<ul>\n<li>Not needing feature engineering anymore</li>\n<li>Incremental, layer-by-layer way in which increasingly complex representations are developed</li>\n<li>Intermediate incremental representations are learned jointly</li>\n</ul>\n</li>\n<li>Three technical forces driving deep learning\n<ul>\n<li>Hardware</li>\n<li>Data</li>\n<li>Algorithms</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"chapter-2-before-we-begin-the-mathematical-building-blocks-of-neural-networks\" style=\"position:relative;\"><a href=\"#chapter-2-before-we-begin-the-mathematical-building-blocks-of-neural-networks\" aria-label=\"chapter 2 before we begin the mathematical building blocks of neural networks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 2: Before we begin: the mathematical building blocks of neural networks</h2>\n<ul>\n<li><em>Tensor</em>: a container for data that generalizes matrices to any arbitrary dimension.</li>\n<li>The tensor’s dimension is also called its axis.</li>\n<li>E.g. A 5D vector of [1, 2, 3, 4, 5] has one axis but five dimensions.</li>\n<li>Dimensionality can denote either the number of entries along a specific axis (as in the case of our 5D vector) or the number of axes in a tensor (such as a 5D tensor).</li>\n<li>A tensor has three key attributes\n<ul>\n<li><em>Number of axes/rank</em>: how many dimensions it takes up</li>\n<li><em>Shape</em>: the description of the axes</li>\n<li><em>Data type</em>: float32, float64, or uint8</li>\n</ul>\n</li>\n<li>E.g. A tensor with shape (60000, 28, 28) means 60000 matrices of size 28 by 28.</li>\n<li>Shape is NOT the same as the tensor’s dimensions.</li>\n<li>E.g. A tensor with shape (6, 1) means 6 vectors of size 1 x 1.</li>\n<li>Seems like shape tends to ignore the last dimension (1) in 1 x 1 for vectors.</li>\n<li><em>Tensor slicing</em>: selecting specific elements from a tensor.</li>\n<li>To slice the dataset</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">my_slice <span class=\"token operator\">=</span> train_images<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>To slice each tensor in the dataset (E.g. To get the 14 x 14 pixels on the bottom-right)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">my_slice <span class=\"token operator\">=</span> train_images<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>The first axis (or axis 0) is often called the batch axis or batch dimension since it’s usually used to control the batch size.</li>\n<li>Real world data tensors\n<ul>\n<li><em>Vector data</em>: 2D tensors of (samples, features)\n<ul>\n<li>E.g. Storing age, ZIP code, and income of each person. (num_people, num_features=3)</li>\n</ul>\n</li>\n<li><em>Timeseries/sequence data</em>: 3D tensors of (samples, timesteps, features)</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/cbbb9f99c1b9c36952ae4374a30a93a5/c5bb3/figure2-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkElEQVQI133Nyw6DIBSEYd//0TBq6hJvGwzDUQ514wUUmtSkq7bfajZ/Jktv27bVj7ooirIsq6oSQjBzSinGmH7LDMDMAKRs2qaVshn6IRc5gDu++/hNtu+7935ZFiJiy84959lqrckQNHwI/54/67quaaK+69Z1TSmd53kcRwheKWXZOueISI0jAGMMoImmF9rk40bsLHOVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 2.3\"\n        title=\"Figure 2.3\"\n        src=\"/CR4-DL/static/cbbb9f99c1b9c36952ae4374a30a93a5/c5bb3/figure2-3.png\"\n        srcset=\"/CR4-DL/static/cbbb9f99c1b9c36952ae4374a30a93a5/63868/figure2-3.png 250w,\n/CR4-DL/static/cbbb9f99c1b9c36952ae4374a30a93a5/0b533/figure2-3.png 500w,\n/CR4-DL/static/cbbb9f99c1b9c36952ae4374a30a93a5/c5bb3/figure2-3.png 680w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n- E.g. Stock prices. (num_days, num_mins_per_day, num_features)\n- <em>Images</em>: 4D tensors of (samples, height, width, channels)\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 692px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/0c9baa9abae92af1014549f015be6392/91e7e/figure2-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVQoz4WOW0+DMACF9/9/mRpLL9sTNbRQugkDewUZl2JYjYsxm19O2r6cnm+3/qaqaoQIIftryGF/mKZpvcPOe++cs9aGEIQQz08v4BXEIIQxwuM43i87r7Vuzk2apjCBsYAgwvj78agcr77vOeOc5ZzxnOc0pQAkBJN/lud5ds4ZY8SGLEsp5THLGEwgwSQByaPysswfbau1FqKMKUuZZQyAZE8OdVUty7Kua/jDTbvrumJDFIUQoqT0DUJ0Ptdt01pr7y7HP4ZhkPK4OV+1Oc/bpgkhWGs67/v+Uyk1DIP3TilljPHe35aj2DSO76fT5XL5EYtnXdc0pVJKzhillGUbSukv3kb5ha9/T1cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 2.4\"\n        title=\"Figure 2.4\"\n        src=\"/CR4-DL/static/0c9baa9abae92af1014549f015be6392/91e7e/figure2-4.png\"\n        srcset=\"/CR4-DL/static/0c9baa9abae92af1014549f015be6392/63868/figure2-4.png 250w,\n/CR4-DL/static/0c9baa9abae92af1014549f015be6392/0b533/figure2-4.png 500w,\n/CR4-DL/static/0c9baa9abae92af1014549f015be6392/91e7e/figure2-4.png 692w\"\n        sizes=\"(max-width: 692px) 100vw, 692px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n- E.g. Batch of 128 grayscale images of 256 x 256. (128, 256, 256, 1)\n- <em>Videos</em>: 5D tensors of (samples, frames, height, width, channels)\n- E.g. 4 Youtube videos that’s 60 seconds long, 5 frames per second, and has a resolution of 1920 x 1080. (num_videos=4, num_frames=300, 1920, 1080, 3)</p>\n<ul>\n<li>Similar to binary operations on binary inputs (E.g. AND, OR, NOT), there are tensor operations.</li>\n<li>We can think of each layer in the network as performing a function.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">//</span> This layer <span class=\"token keyword\">is</span> doing the same <span class=\"token keyword\">as</span> the following line of code\noutput <span class=\"token operator\">=</span> relu<span class=\"token punctuation\">(</span>dot<span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>The steps each layer does\n<ul>\n<li>Dot product of the weights and input</li>\n<li>Add the result with a bias</li>\n<li>Pass the result through a rectified linear function</li>\n</ul>\n</li>\n<li>A dense layer is the same as a fully connected layer.</li>\n<li><em>Element-wise operations</em>: an operation on a vector’s individual elements.</li>\n<li>Since element-wise operations are independent of each other, it can be parallelized.</li>\n<li>When adding two tensors of different shapes, the smaller tensor is broadcasted to match the shape of the larger tensor.</li>\n<li>Steps to broadcast a smaller tensor into a larger one\n<ul>\n<li>Add axes to the smaller tensor to match the number of dimensions of the larger tensor.</li>\n<li>Repeat the smaller tensor alongside the new axes to match the full shape of the larger tensor.</li>\n</ul>\n</li>\n<li>E.g. Let X have shape (32, 10) and Y have shape (10, ). To broadcast Y to X, first add another axis to Y to get (1, 10). Then repeat Y 32 times in that new axis to get (32, 10).</li>\n<li><em>Tensor dot</em>: the same as vector dot product. Multiply each corresponding component and then sum the results.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 694px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/3178fe83043cfe77fc4699a8ab906727/31198/figure2-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQoz41R207CQBDt//+KROOzvhACmpiIKBCIqC3Q6tJ2b93uZfZSQht9QuA8TCaTc+acyUTNMYQQvG+klFrrtvdHadHRKWMsz5eM0e8sQwgpJU+JvXPGaOfcofeeMcr52FqTpRnGBABOicGCqKqO1IoZZRMLpjtBa31pbCEExpiQcZZuizxXShljLhWH1pmxCbTO3vvzzt57JdVfbM5frD0XO4TAeUUIJZRiTDjjlDKEUFHOhKikVEIIKWW3JXT1F5ExGowqUfqTbjpG0zS1qAwYAFguFuk2/ffPWtb9yfpq8NEbrK5HX7cPcW8Yj94SRD611tYenuecIwdQpdRulxNCyrIoSxwF78aLZDTd3D3Ob+6f+s+r4Wsyfd8UJMMYK6WstQAQx/F8NkuSdXeFEELU9R4ZcnrIoIQOiwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 2.5\"\n        title=\"Figure 2.5\"\n        src=\"/CR4-DL/static/3178fe83043cfe77fc4699a8ab906727/31198/figure2-5.png\"\n        srcset=\"/CR4-DL/static/3178fe83043cfe77fc4699a8ab906727/63868/figure2-5.png 250w,\n/CR4-DL/static/3178fe83043cfe77fc4699a8ab906727/0b533/figure2-5.png 500w,\n/CR4-DL/static/3178fe83043cfe77fc4699a8ab906727/31198/figure2-5.png 694w\"\n        sizes=\"(max-width: 694px) 100vw, 694px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><em>Tensor reshaping</em>: change the shape of a tensor while maintaining its data.</li>\n<li>E.g. Changing from (3, 2) to (6, 1).</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>A common tensor reshaping operation is transposing which switches the rows and columns.</li>\n<li>Neural network → chain of tensor operations → geometric transformations of the input data.</li>\n<li>So an ANN can be interpreted as a very complex geometric transformation in a high-dimensional space.</li>\n<li>The analogy is that machine learning takes a crumpled paper ball and uncrumples it which is like finding the neat representations for complex, highly folded data manifolds.</li>\n<li>ML uncrumples the ball by incrementally decomposing a complicated geometric transformation into a long chain of elementary ones.</li>\n<li>It’s a reductionist approach.</li>\n<li>The weights of the neural network contain information learned by the network from exposure to training data.</li>\n<li>The training loop\n<ul>\n<li>Draw a batch of training samples.</li>\n<li>Run the network on those samples to predict the target.</li>\n<li>Compute the loss/error of the network on the batch.</li>\n<li>Update all weights of the network to slightly reduce the loss on this batch.</li>\n</ul>\n</li>\n<li>The intuition behind a continuous function is that a small change in x must result in a small change to y.</li>\n<li>An ANN can be thought of as moving towards the lowest point on the error map where the gradient points which direction to head down and how steep the slope it.</li>\n<li><em>Stochastic gradient descent (SGD)</em>: randomly sampling an input and using its error to descent the error map.</li>\n<li>Stochastic refers to how each batch of data is randomly drawn.</li>\n<li>Mini-batch stochastic gradient descent versus Stochastic gradient descent: each iteration uses a batch of data instead of a single sample.</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>SGD</th>\n<th>Mini-batch SGD</th>\n<th>Batch SGD</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Input/Sample Size per Iteration</td>\n<td>Single</td>\n<td>Batch or subset</td>\n<td>Entire set</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>Momentum address two issues with SGD\n<ul>\n<li>Convergence speed</li>\n<li>Local minima</li>\n</ul>\n</li>\n<li>Momentum draws inspiration from physics. The mental image is to think of the optimization process as a small ball rolling down the loss curve. If the ball has enough momentum, it won’t get stuck in the local minimum.</li>\n<li>Momentum is implemented by moving the ball at each step based not only on the current slope value (current acceleration) but also on the current velocity (resulting from past acceleration).</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">past_velocity <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nmomentum <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span>\n<span class=\"token keyword\">while</span> loss <span class=\"token operator\">></span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">:</span>\n  w<span class=\"token punctuation\">,</span> loss<span class=\"token punctuation\">,</span> gradient <span class=\"token operator\">=</span> get_current_parameters<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  velocity <span class=\"token operator\">=</span> past_velocity <span class=\"token operator\">*</span> momentum <span class=\"token operator\">+</span> learning_rate <span class=\"token operator\">*</span> gradient\n  w <span class=\"token operator\">=</span> w <span class=\"token operator\">+</span> momentum <span class=\"token operator\">*</span> velocity <span class=\"token operator\">-</span> learning_rate <span class=\"token operator\">*</span> gradient\n  past_velocity <span class=\"token operator\">=</span> velocity\n  update_parameter<span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><em>Backpropagation</em>: applying the calculus chain rule to the computation of gradients in an ANN.</li>\n<li><em>Symbolic differentiation</em>: given a chain of operations with a known derivative, compute a gradient function for the chain that maps network parameter values to gradient values.</li>\n<li><em>Epoch</em>: each iteration over all of the training data.</li>\n</ul>\n<p><strong>Summary</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 773px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/c0aa2802c447767ac75ff2f7ba84a7be/612f7/chapter2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACjElEQVQ4yz1T6ZKjIBDO+7/YbjLGG1SgucFEjVdiJj+30JmtoqgGquG7ON3vQAAJVRtLQGDr6eftvzf/frnv7ac46v/z/+I0TcoYDLwAyAnNpETeIu/qR8esLp1G/Z3efO1tdfOVM7hrm32Jl1mdPlv72ZzkqYREQAIkEpC2Dltdeotbi41GRhVGlYpnRpXOYqOK1lXrrE/vl3suyshcQspZAvTa3cg8iqFj04OPAzw69uhhfPBp4KEY+LgXr9Wc3i//nKXkmdNIi0zJXPCUs1jyHOiVkavVpRK5lrnimQxHiRI5Z8k4QHh5e1pGIskzASmQK2m+OI33/hRoQpuINhGpv0j9BTSm5AosZjTuO/bTrFWhRXFcqWVudallrkXuHe5udOjo0LGhZ/2d9ncauPSwLvr03vxzFkpk1iBnkdWlUYUzqHWVkbm3eOhY39GdbRhDzx49Gzr2Wm14+bXqgJDEAtIDYYPPtI7q6sxpzJqoxmfaREDjBl9oEzES4fLP0P9yViIDSIIxsjCysBodOjmDvMVKBsGCqAZJnlmNJE+XSQXY6yzUfhCgBksDeaNKE3qKQH73WfKsdTgoYkrJ02mUO+xFcxYzcoUgcgI01iLjLJGQ7M2FhFRA2LEaaVlwlnAWTw/x47OWeciNrVpfa5X3d7ouah7lOuvnopdJLpNaZ/U7y9dq9pBs/rmogFMW1iCrimCbCm5Jnof9UKQCUrf7FxDtHH+bZ2FUCNCepOJA4Qx2BjmDlMjCdYdguhQsNftyHsXRLDkkTXUh1QWXf2kTNdUFaAw0CCEgaV0l4AhmVqMzZ6mEdNw5u+3pQgw61t1IiMSddjfy6EISxoFvT/t5t8f43vxe+OOr/wPCgX/v3Lv+dgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chapter 2\"\n        title=\"Chapter 2\"\n        src=\"/CR4-DL/static/c0aa2802c447767ac75ff2f7ba84a7be/612f7/chapter2.png\"\n        srcset=\"/CR4-DL/static/c0aa2802c447767ac75ff2f7ba84a7be/63868/chapter2.png 250w,\n/CR4-DL/static/c0aa2802c447767ac75ff2f7ba84a7be/0b533/chapter2.png 500w,\n/CR4-DL/static/c0aa2802c447767ac75ff2f7ba84a7be/612f7/chapter2.png 773w\"\n        sizes=\"(max-width: 773px) 100vw, 773px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"chapter-3-getting-started-with-neural-networks\" style=\"position:relative;\"><a href=\"#chapter-3-getting-started-with-neural-networks\" aria-label=\"chapter 3 getting started with neural networks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 3: Getting started with neural networks</h2>\n<ul>\n<li>Neural networks have four components\n<ul>\n<li>Layers</li>\n<li>Input data and corresponding targets</li>\n<li>Loss function to define the feedback signal used for learning</li>\n<li>Optimizer to determine how learning proceeds</li>\n</ul>\n</li>\n<li>The fundamental data structure in neural networks is the layer.</li>\n<li>Different layers are used for different input formats.\n<ul>\n<li>Use dense/fully connected layers for 2D tensors (basic)</li>\n<li>Use recurrent layers for 3D tensors (time series)</li>\n<li>Use 2D convolution layers for 4D tensors (images)</li>\n</ul>\n</li>\n<li><em>Layer compatibility</em>: layers only accept input tensors of a certain shape and will return output tensors of a certain shape.</li>\n<li>Keras automatically handles layer compatibility.</li>\n<li>The loss function is a measure of success for the task.</li>\n<li>The optimizer determines how the network will be updated.</li>\n<li>Guidelines for choosing the loss function\n<ul>\n<li>Two-class classification → Binary crossentropy</li>\n<li>Many-class classification → Categorical crossentropy</li>\n<li>Regression → Mean-squared error</li>\n<li>Sequence-learning → Connectionist temporal classification</li>\n</ul>\n</li>\n<li>Keras is a model-level library that uses a backend engine for tensor calculations.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 586px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/52212a2894e5d435f6e42eb7f1197ebf/a76f4/figure3-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQY03XNS0sCQQDA8f1QEdSh16ZrwlYXjx2CKBKhs5+lU3WQoKAXRVjHiMTFcFfXndmHzuzLZh/O5oKK7Uae7X//8Wc+ljaFzI7A8nWWl/aL4t5Rnd0WWF7I7r4vrKHTszRNk+k0nRejHK62S1utYq5d5GC5oJQLnVJOOubASR4cLJOHGf75B8d3K91Lzqhk7CsOVzbUi3X3OqNXsoP7/OR2caycz86TZF6MVnvEn1Wr+Sq/3Qyt1shpo8YzblRh7cluvowDnPzpZP65jxSkSlht2YZMPYcSu49AD4pd0CQYjL79OI4RQh7xoihyHNd1HduyTNP8Ih4ThBSqOlS1IKRhSD0/8IOBAmCvh/1gMBzGEaWiJGqajjEGECqdjmHosiwT4v0CGFMoz38KmaYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 3.3\"\n        title=\"Figure 3.3\"\n        src=\"/CR4-DL/static/52212a2894e5d435f6e42eb7f1197ebf/a76f4/figure3-3.png\"\n        srcset=\"/CR4-DL/static/52212a2894e5d435f6e42eb7f1197ebf/63868/figure3-3.png 250w,\n/CR4-DL/static/52212a2894e5d435f6e42eb7f1197ebf/0b533/figure3-3.png 500w,\n/CR4-DL/static/52212a2894e5d435f6e42eb7f1197ebf/a76f4/figure3-3.png 586w\"\n        sizes=\"(max-width: 586px) 100vw, 586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>There are two ways to define a model\n<ul>\n<li>Sequential for linear stacks of layers.</li>\n<li>Functional API for arbitrary architectures.</li>\n</ul>\n</li>\n<li>Use separate sets of data for training and testing. Reasons being\n<ul>\n<li>Performing well on the training set doesn’t mean the model will perform well on new data.</li>\n<li>You only care about the model’s performance on new data.</li>\n<li>The model might end up memorizing a mapping between the training samples and the target instead of actually using the training data.</li>\n</ul>\n</li>\n<li>You can’t feed lists of integers into a neural network, you have to turn them into tensors. There are two methods to do this.</li>\n<li>First method is to pad the lists so that they’re the same length</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">y_train <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>asarray<span class=\"token punctuation\">(</span>train_labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float32'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Or use</span>\ny_train <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>train_labels<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>Second method is to one-hot encode</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">vectorize_sequences</span><span class=\"token punctuation\">(</span>sequences<span class=\"token punctuation\">,</span> dimensions<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  results <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sequences<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dimensions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> sequence <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>sequences<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    results<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> sequence<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n  <span class=\"token keyword\">return</span> results</code></pre></div>\n<ul>\n<li><em>Hidden unit</em>: a dimension in the representation space of the layer.</li>\n<li>Dimensionality can intuitively be thought of as how much freedom you’re allowing the network to have when learning internal representations.</li>\n<li>More hidden units allows for learning more complex representations but it increases the use of resources and may lead to learning unwanted patterns.</li>\n<li>The two key architecture decisions to make for dense layers are\n<ul>\n<li>How many layers to use</li>\n<li>How many hidden units to choose for each layer</li>\n</ul>\n</li>\n<li><em>Rectified linear unit (ReLU)</em>: zeros out negative values and maintains positive values.</li>\n<li><em>Sigmoid</em>: squashes arbitrary values to between 0 and 1.</li>\n<li>Activation functions are required to get access to a richer hypothesis space for deep representations. It must be non-linear as <code class=\"language-text\">output = dot(W, input) + b</code> is a linear transformation.</li>\n<li>Crossentropy is usually the best loss function when dealing with models that output probabilities.</li>\n<li>Crossentropy measures the distance between probability distributions.</li>\n<li>Example of custom optimizer, loss, and metric</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>\n  optimizer<span class=\"token operator\">=</span>optimizers<span class=\"token punctuation\">.</span>RMSprop<span class=\"token punctuation\">(</span>lr<span class=\"token operator\">=</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  loss<span class=\"token operator\">=</span>losses<span class=\"token punctuation\">.</span>binary_crossentropy<span class=\"token punctuation\">,</span>\n  metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>metrics<span class=\"token punctuation\">.</span>binary_accuracy<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>If the training loss and accuracy improve but the validation metrics don’t, then the model is over-fitted.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">results <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> y_test<span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><em>Single-label, multiclass classification</em>: each label can only belong to one category.</li>\n<li>E.g. Each picture can only be labeled as either cat or dog. There are multiple classes (cat, dog) but each picture can only get one label.</li>\n<li><em>Multi-label, multiclass classification</em>: each label can belong to multiple categories.</li>\n<li>E.g. Each picture can have both a cat and dog so there each picture can get multiple labels.</li>\n<li>If you’re trying to predict data with N classes, then end the network with a dense layer of size N.</li>\n<li>If a layer drops information relevant to classification, then that information can never be recovered as each layer can become an information bottleneck.</li>\n<li>If not using categorical encoding/one-hot such as using integer labels, use <code class=\"language-text\">sparse_categorical_crossentropy</code> instead of <code class=\"language-text\">categorical_crossentropy</code>. It’s mathematically equivalent.</li>\n<li>As a rule of thumb, hidden layers shouldn’t have fewer units than the output layer.</li>\n<li>Predicting discrete labels is categorization, predicting continuous labels is regression.</li>\n<li>Logistic regression (a classification method) =/= regression.</li>\n<li>It’s problematic to feed an ANN with feature values that vary widely as it will slow down learning due to large gradient updates preventing convergence.</li>\n<li>E.g. House features such as money, house square feet, year built all have different ranges.</li>\n<li>To deal with this, normalize the features using a z-score so that the feature has a mean of 0 and a standard deviation of 1.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Calculate the mean and std to normalize the training data</span>\nmean <span class=\"token operator\">=</span> train_data<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ntrain_data <span class=\"token operator\">-=</span> mean\nstd <span class=\"token operator\">=</span> train_data<span class=\"token punctuation\">.</span>std<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ntrain_data <span class=\"token operator\">/=</span>std\n\n<span class=\"token comment\"># Apply the normalization to the test data</span>\ntest_data <span class=\"token operator\">-=</span> mean\ntest_data <span class=\"token operator\">/=</span> std</code></pre></div>\n<ul>\n<li>Apply the computed values to the test data but never calculate the values using the test data, even data normalization.</li>\n<li>In general, the less training data there is, the worse overfitting will be. Mitigate this by using a smaller network.</li>\n<li>When doing regression, use a linear activation layer for the last layer.</li>\n<li><em>Mean squared error (mse)</em>: the square of the difference between the predictions and the targets.</li>\n<li><em>Mean absolute error (mae)</em>: the absolute value of the difference between the predictions and the targets.</li>\n<li>A small dataset leads to challenges with picking the validation and testing set. The validation set might have high variance which makes evaluating the model difficult.</li>\n<li><em>K-fold cross-validation</em>: splitting the available data into K partitions, starting K identical models, and training each one on K - 1 partitions.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/c4451/figure3-11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVElEQVQoz22R23LbMAxE9f8fl07dppanamK5tiQSvIFXkJSZjiy3fcl54nBmsQts9/GgtVZrWWtFY7TSG2qDiHLOtdaPz+hSSuu6aqXH8TKO4zTNWmuLaNHuD0T03qeUQgjOuZxza+0pdtaVUoDD8dh/f/0x/ByAc6WUFJIzZrRWUjlrYwiMscvld/C+tae822cE740x1lqjtQCBBpXcYgfvN2WM/6JSSvf7/ekshfDeIyLnfJomKcTh6+Hl5cvh8O16u0kpAcAiGq3neX779ea9d86dz2fO+dN5/4oxIuI0TQBiWRYpJRGFENLDmXJOKRFRKcU5V2vtnHNEZK1ljM3zLAA4Z/va5/f3/tj3x55zTkR7wH3n/9eutSLi1tCjHgFgjFFKDcNw6k99f1qWhYgA4Hq9xRjb34t1ztrgN7aC1VYxAAgBMcaccykl57yu66c9/wETIf5omr8O1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 3.11\"\n        title=\"Figure 3.11\"\n        src=\"/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/00d43/figure3-11.png\"\n        srcset=\"/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/63868/figure3-11.png 250w,\n/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/0b533/figure3-11.png 500w,\n/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/00d43/figure3-11.png 1000w,\n/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/c4451/figure3-11.png 1450w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Once you’re finished tuning the parameters of the model, you can train the final production model on the combination of the training and validation dataset.</li>\n</ul>\n<p><strong>Summary</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 856px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/94698b446afd763c24286284306cafed/ad12c/chapter3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMUlEQVQoz1WT25KkIAyG+/3fbnYVUVQOIRwEPNs9e7cF9szOVlFWQpnkyx/yiFF1IxXAAIdBtNqOn5f7fPrX5V7F+HFcOV/2Kzz2zSB2QhCDbBhrIcgchTVdmMbghxR48MPkhsmyWG68ZcH3k2fn7h6fT//n6YymCI1BioqAqMfhlyxfJWolCc9upUQ19B+C/0bVjMPHtuLjdfnnYYymUtQy/1ojUMkrKWqtiFYNSJJTiErL7CpRKUkstq9rysHXDs501nQaGgSabewstpPvLbbeMARa0Gh2bTcV+PNwJfgwFluL7bHjdZjrtMemz91chzl33Fc4dzz3f/axZeN5+buylqJC1WhojKZGt1o1WjWoKYja6HZJIosX+ZJkCnyO3Dv2PL+CnWUgCUiCN7llWhGLnVYkhXGdVQxjmsY5im2BFPiSxDe2RqAgs0IgieSVM50SNSgC5UZLEqex1BTrom7jHXwWwbIepnOm85ZZbO/hWXy7k+1jyHMOfogF4frG9pZh7vaWOotnTTe53hf+OI1FPHNselvUOqt1kW/Bzk3fAQiNt0zyygA1mHPlwZapOtOBIt6ydc6a5XS58tOfG0B5ADctKOIyP7vJve0RKKrGG+ZdP0exJDlH/sY+N9BAQDWSV0rWKfBtUdsCGW9WN+eSss5rCVuSSIF/9wwqP8ac22jKx193t96yGEZfVLyFTFFMro/TiECPzTzu1bs7WWc1RzEn8WP1/juv97be6xn+AksnX7rT2I4OAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chapter 3\"\n        title=\"Chapter 3\"\n        src=\"/CR4-DL/static/94698b446afd763c24286284306cafed/ad12c/chapter3.png\"\n        srcset=\"/CR4-DL/static/94698b446afd763c24286284306cafed/63868/chapter3.png 250w,\n/CR4-DL/static/94698b446afd763c24286284306cafed/0b533/chapter3.png 500w,\n/CR4-DL/static/94698b446afd763c24286284306cafed/ad12c/chapter3.png 856w\"\n        sizes=\"(max-width: 856px) 100vw, 856px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"chapter-4-fundamentals-of-machine-learning\" style=\"position:relative;\"><a href=\"#chapter-4-fundamentals-of-machine-learning\" aria-label=\"chapter 4 fundamentals of machine learning permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 4: Fundamentals of machine learning</h2>\n<ul>\n<li>The central problem of deep learning is overfitting.</li>\n<li>Four branches of machine learning\n<ul>\n<li><em>Supervised learning</em>: learning to map input data to known targets.\n<ul>\n<li>Classification</li>\n<li>Regression</li>\n<li>Sequence generation</li>\n<li>Object detection</li>\n<li>Image segmentation</li>\n</ul>\n</li>\n<li><em>Unsupervised learning</em>: finding interesting transformation of the input data without the help of any targets.\n<ul>\n<li>Dimensionality reduction</li>\n<li>Clustering</li>\n</ul>\n</li>\n<li><em>Self-supervised learning</em>: a specific instance of supervised learning without human-annotated labels.\n<ul>\n<li>Autoencoders</li>\n<li>Temporally supervised learning</li>\n</ul>\n</li>\n<li><em>Reinforcement learning</em>: an agent received information about its environment and learns to choose actions that will maximize some reward.</li>\n</ul>\n</li>\n<li>These four branches are sometimes blurry and aren’t well defined. It’s more of a continuum than distinct.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/6027aecaf84dd76b571e9f763b69ed07/c425d/class-and-regress-gloss-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPklEQVQY00WQ2WrDMBRE/f9/1iT1EsubrjZriTfZibyq6UtJSimch8PAwDDB4665BC5BGWoarm5MGqIbLjWtNVnm5umHr6N/85KnH55++P6yfu+C0QqEzhk6F0WIcZxcP1J0yrNLUYZ5fiGQUIgpJJxea460zDlLBUuhCkfLg9HyLP2A6pNCVAvESEQhwuUnpwnBIYUElyHgsOaIkpizKy5DAlGOTrZnweJM1+DGVO6hFqfX2SzOzE67u5ofenH6N1yXm7vLdTZ+746tPbZuX9vAH/2+KCUQgVirouZI1hkjMaevqRRiRhLxntre8GOSx9bua7OvzbG1gd+7bZYMogydoAoBR2VxqYoL4IiRV1/w9CUkaW/Y6NKoom+JqrPJisAfnd96N6lx4G/EZMVoxWTrv5+HX46t8/s/x9b9APSIdP/pUzZeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Classification and regression glossary 1\"\n        title=\"Classification and regression glossary 1\"\n        src=\"/CR4-DL/static/6027aecaf84dd76b571e9f763b69ed07/00d43/class-and-regress-gloss-1.png\"\n        srcset=\"/CR4-DL/static/6027aecaf84dd76b571e9f763b69ed07/63868/class-and-regress-gloss-1.png 250w,\n/CR4-DL/static/6027aecaf84dd76b571e9f763b69ed07/0b533/class-and-regress-gloss-1.png 500w,\n/CR4-DL/static/6027aecaf84dd76b571e9f763b69ed07/00d43/class-and-regress-gloss-1.png 1000w,\n/CR4-DL/static/6027aecaf84dd76b571e9f763b69ed07/c425d/class-and-regress-gloss-1.png 1279w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/b65fd5dbc90197e7b9fd8d0add6d013f/0d98f/class-and-regress-gloss-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4ElEQVQoz01S147bMBC8//+wIHCTVVhELjtFsUg6O45yrwHlQxCAD1wCwyk7H197/POarB4EtM5gq1Hw1FusZRcD2xa1ZPnY7LbqHMWS5VJkTvC56ufDfbzBEu58vEloR3obyZWgM0EnRm/O1u+07IMfJ0eV6IwanCUK2sdmD/Dv4AwG1mjVL1mtRcWZ5whLliWJFCHNfC36PVby4/L8fDP/8gpaKVrB785gLXtr0OTI5IgzCHhjdR2tqtaU6JzBEtpv8P4K1iAlOgl3owc8nDi7cXZj9AqsCdO4ZJlmHsOYZp4iLwliYK/n9PG1p/2X07IDfg9+XIt6B1ayiIE5gx+bLUkET9ei5mnMqb6nmb+Z037IVqLzjjiL82FsciR4miIPfkyRL1kchkUKPMcaxHdg+8sr0RJ0Gum1HnIRR/gUn/v2B6PXqnaGHOtJMy8RgqePzXynfSzpqmVP8FlWCThM1KrBGeQtfofkHTmSq6Y4a5Ys/+25pfgs+J2g0+TIYzMlwUHIaysi5AQlVeUlixzhv1W9Ji07jE58bA61F0Zvgt+BN6j/qVVP8QVYM5KLFB3FtT94OOUEFfy1p8lRCa3VyKjBqsHIwchey96oXkBrNDKyd6ZW7Wir+Vz16+n/AvjFd7XlpNbzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Classification and regression glossary 2\"\n        title=\"Classification and regression glossary 2\"\n        src=\"/CR4-DL/static/b65fd5dbc90197e7b9fd8d0add6d013f/00d43/class-and-regress-gloss-2.png\"\n        srcset=\"/CR4-DL/static/b65fd5dbc90197e7b9fd8d0add6d013f/63868/class-and-regress-gloss-2.png 250w,\n/CR4-DL/static/b65fd5dbc90197e7b9fd8d0add6d013f/0b533/class-and-regress-gloss-2.png 500w,\n/CR4-DL/static/b65fd5dbc90197e7b9fd8d0add6d013f/00d43/class-and-regress-gloss-2.png 1000w,\n/CR4-DL/static/b65fd5dbc90197e7b9fd8d0add6d013f/0d98f/class-and-regress-gloss-2.png 1276w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/e9cdf9d7d70ab0b3af351ff64863e4a7/0d98f/class-and-regress-gloss-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWklEQVQY0z2Q6W7bQAyE/f4PViB1tJJWxx5c7qFzD8lymip20j+FrbQAQXAIDL7BnG67/3gfnakMUqOps/XQsUM6TQ2WBqk1tUGqVXn8O9v0rrks9vQ0TwiFFKSpX8aeXxYbvYpBpYDR4xL1upg16RQwzGpNZom4RHx/G07/yQiFNZVRZe9ahEJjaXWlVSnYq0YKMremEuzVaCoFQSj+kXdvkEpOrKkfEVhmkE4jTwGngfeu6bo2eBVm6Uw9jcJPchzYdetOtz3sv3qUueBZZ2uEXMl8GrifIXgIs5oG4WcYe/7w9CzMEL2aR7Fd3IN8273F6giJUAw9k5w01QsIAiIHQVj9U6sCBOHtGaHk7Zk15yXqZ+zfMwhCix+SZ4JnShDBM5TF0LVK5lqVIIj9brvGJwAh31b3bX7buhRwW+11dWsy10v353P5vMVjvu7puY/7Ib/u6f4R/gK+uaVpm84uagAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Classification and regression glossary 3\"\n        title=\"Classification and regression glossary 3\"\n        src=\"/CR4-DL/static/e9cdf9d7d70ab0b3af351ff64863e4a7/00d43/class-and-regress-gloss-3.png\"\n        srcset=\"/CR4-DL/static/e9cdf9d7d70ab0b3af351ff64863e4a7/63868/class-and-regress-gloss-3.png 250w,\n/CR4-DL/static/e9cdf9d7d70ab0b3af351ff64863e4a7/0b533/class-and-regress-gloss-3.png 500w,\n/CR4-DL/static/e9cdf9d7d70ab0b3af351ff64863e4a7/00d43/class-and-regress-gloss-3.png 1000w,\n/CR4-DL/static/e9cdf9d7d70ab0b3af351ff64863e4a7/0d98f/class-and-regress-gloss-3.png 1276w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>We split the input data into a\n<ul>\n<li>Training set</li>\n<li>Validation set</li>\n<li>Testing set</li>\n</ul>\n</li>\n<li>Because if we use all of the data, the model starts overfitting.</li>\n<li>The goal of machine learning is to achieve models that generalize to perform well on never-before-seen data.</li>\n<li>So a measure of generalization power of the model is important.</li>\n<li>The hyperparameters of the model are the controllable factors of the model.</li>\n<li>E.g. Number of neurons, number of layers, learning rate, optimization method.</li>\n<li>The parameters of the model are the network’s weights.</li>\n<li>Be careful to not tune the hyperparameters too much to the validation set as you could be overfitting to the validation set.</li>\n<li>Three ways to split the train, valid, and test sets</li>\n<li>Simple hold-out validation\n<ul>\n<li>Set apart some fraction of the data as the test set.</li>\n<li>However, if little data is available, then the validation and test sets may contain too few samples.</li>\n<li>Recognize this problem if the model shows variance based on the train-test split.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 942px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/ee1b41cefce6641777cbe5922d304ff3/f1901/figure4-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVQY04WP226EIBRF/f//avveNs48CKMzpiBXFQ8oAWyEadoHk66c5Nyys7OrGOO+78YYzjgl9Cg6DMMwjuP+H5X+QWWEEEoprbUUQkp5XLjw3p+LU0oxU/aUUgghpSSFxPjWth1CGADK61eXx6rM1jnBudY6hFAu4zh+vH++vrzV9dUCPO6PrrsfkShtUPNFCGPs6ey9t9Y650IIMcaUkuACIVxfrk2DjDFSyr7vMb5RStu2nc0SY6yWDAAUMQAYYwCAMTYwppQmhDjnzjOv6+q9n6aJHzBr7ZYJISzLIoWw1pbAf3mKS9u2zWbzkrm853lGDSriU+dv2tXLhDtVFo0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 4.1\"\n        title=\"Figure 4.1\"\n        src=\"/CR4-DL/static/ee1b41cefce6641777cbe5922d304ff3/f1901/figure4-1.png\"\n        srcset=\"/CR4-DL/static/ee1b41cefce6641777cbe5922d304ff3/63868/figure4-1.png 250w,\n/CR4-DL/static/ee1b41cefce6641777cbe5922d304ff3/0b533/figure4-1.png 500w,\n/CR4-DL/static/ee1b41cefce6641777cbe5922d304ff3/f1901/figure4-1.png 942w\"\n        sizes=\"(max-width: 942px) 100vw, 942px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">num_validation_sample <span class=\"token operator\">=</span> <span class=\"token number\">10000</span>\nnp<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>shuffle<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Define the validation set</span>\nvalidation_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>num_validation_samples<span class=\"token punctuation\">]</span>\ndata <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>num_validation_samples<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Define the training set</span>\ntraining_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\nmodel <span class=\"token operator\">=</span> get_model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span>training_data<span class=\"token punctuation\">)</span>\nvalidation_score <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>validation_data<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># At this point, you can tune your model,</span>\n<span class=\"token comment\"># retrain it, evaluate it, and tune it again.</span>\n\n<span class=\"token comment\"># Train the final model on all non-testing data</span>\nmodel <span class=\"token operator\">=</span> get_model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>training_data<span class=\"token punctuation\">,</span> validation_data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ntest_score <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>test_data<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>K-fold validation\n<ul>\n<li>Split the data into K partitions of equal size.</li>\n<li>For each partition i, train the model on the remaining K - 1 partitions and evaluate on partition i.</li>\n<li>Your final score is the averages of the K scores.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/c4451/figure3-11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVElEQVQoz22R23LbMAxE9f8fl07dppanamK5tiQSvIFXkJSZjiy3fcl54nBmsQts9/GgtVZrWWtFY7TSG2qDiHLOtdaPz+hSSuu6aqXH8TKO4zTNWmuLaNHuD0T03qeUQgjOuZxza+0pdtaVUoDD8dh/f/0x/ByAc6WUFJIzZrRWUjlrYwiMscvld/C+tae822cE740x1lqjtQCBBpXcYgfvN2WM/6JSSvf7/ekshfDeIyLnfJomKcTh6+Hl5cvh8O16u0kpAcAiGq3neX779ea9d86dz2fO+dN5/4oxIuI0TQBiWRYpJRGFENLDmXJOKRFRKcU5V2vtnHNEZK1ljM3zLAA4Z/va5/f3/tj3x55zTkR7wH3n/9eutSLi1tCjHgFgjFFKDcNw6k99f1qWhYgA4Hq9xRjb34t1ztrgN7aC1VYxAAgBMcaccykl57yu66c9/wETIf5omr8O1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 3.11\"\n        title=\"Figure 3.11\"\n        src=\"/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/00d43/figure3-11.png\"\n        srcset=\"/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/63868/figure3-11.png 250w,\n/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/0b533/figure3-11.png 500w,\n/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/00d43/figure3-11.png 1000w,\n/CR4-DL/static/b9b14016a0f974b3e9da3f92b42f5187/c4451/figure3-11.png 1450w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># The number of folds</span>\nk <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nnum_validation_samples <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> k\nnp<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>shuffle<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n\nvalidation_scores <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> fold <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  validation_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>num_validation_samples <span class=\"token operator\">*</span> fold<span class=\"token punctuation\">:</span>\n    num_validation_samples <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>fold <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n  training_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>num_validation_samples <span class=\"token operator\">*</span> fold<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span>\n    data<span class=\"token punctuation\">[</span>num_validation_samples <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>fold <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n    model <span class=\"token operator\">=</span> get_model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    model<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span>training_data<span class=\"token punctuation\">)</span>\n    validation_score <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>validation_data<span class=\"token punctuation\">)</span>\n    validation_scores<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>validation_score<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Calculate the average validation score</span>\nvalidation_scores <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>average<span class=\"token punctuation\">(</span>validation_scores<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Train the final model on all non-testing data</span>\nmodel <span class=\"token operator\">=</span> get_model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\ntest_score <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>test_data<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>Iterated K-fold validation with shuffling\n<ul>\n<li>Use this when there is very little data</li>\n<li>Apply K-fold validation multiple times, shuffling the data every time before splitting it K-ways.</li>\n<li>The final score is the average of the scores obtained from each run of K-fold validation.</li>\n</ul>\n</li>\n<li>Things to keep in mind\n<ul>\n<li><em>Data representativeness</em>: ensure to shuffle your data before splitting it into the training and test sets.\n<ul>\n<li>E.g. If taking the first 80% of a digits data set for training, then the training set only contains classes of 0-7 where the test set contains only classes 8-9.</li>\n</ul>\n</li>\n<li><em>Arrow of time</em>: don’t shuffle the data if you’re trying to predict future events from the past because the order matters.\n<ul>\n<li>E.g. Stock market, weather, music.</li>\n</ul>\n</li>\n<li><em>Redundancy in the data</em>: if duplicate data ends up in both the training and testing set, then the network will train on the testing set which introduces bias.</li>\n</ul>\n</li>\n<li>Data preprocessing for neural networks\n<ul>\n<li><em>Vectorization</em>: convert all data into tensors.\n<ul>\n<li>Done because neural networks only take in tensors as input.</li>\n</ul>\n</li>\n<li><em>Value normalization</em>: convert all data into the same range with a mean of 0 and a standard deviation of 1.\n<ul>\n<li>Done because a large variations in the input data can cause large gradient updates preventing the model from converging.</li>\n</ul>\n</li>\n<li><em>Missing values</em>: set missing data to zero so the model learns zero to mean missing data.\n<ul>\n<li>Done because neural networks can’t handle missing values.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><em>Feature engineering</em>: the process of using your own knowledge of the data to make the model work better.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 613px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/160802e4c5430dcd53770df708771861/5754a/figure4-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAACV0lEQVQ4y5VTa2+cMBC8///r0lMSFULOB+Z5+I1t/AJXxheaSv3QjlZg1juwnh0u8W/gjC3Lsu/7Z1UxSmOMIQTOeV3XhBDOufc+xniJMTJKYdP2ff94zDFGs65oTos7ALCBGOMYIyV01WtVfQghnHMIoSeZEFyWH8XPIpOtMWhOe1JKY0yuE5znXvY9rutKj3YSedv2jLNtIQTnPITAONNaxxj3fSeE5NcRQkIIiRxC8N4758KfkFJihJRS27Z570MIzrl5nhlj1tpt20IIF7ksQgit1HJ8TXyFOiCXJSfTdVm01t8rL1nb2w0o9WzvOMjGGMMIK72eSWMMJXR+zN67fLpERgj9+HG93cCq1y9yGMexaSAh5CQvQnRd3zaQUp6TiUwpKYuiKMv393culjRV7yFs7+COED7J8zz3fX8HYJoev8lKqa7r2q6t68YYG48djMk4jJSyk+yspYR2bauPs6S2lwNaqRQ6ifEUTEqlZJLzS0K5LFnFs+aybZu17girtc4z896b1VhrjTF5TiEEm55TxrlnJrWNEb6De13XNwCsS0quWr++vsIGjsOU/RBjbOq6KMq+H4Zh/C4YfXt7+6wqKVWuc841DRz6IdsrA6G5hS1jbH7MWYXD2xhfr9ey/LiD2lh7KpQXJ77/djmTyN65Qy2drOdc/GdcKKVCJBnXddVaY4wJwYwxgglCCBNCMGGMUUof0yPdCUUIUUqlVJeiKF5eXj6rinPBGIMQdl03TRMAAMKm67rDFdM4DgCApq7HcYRtOww9pfTCOe+HITvpf/EL1ZU/PDm28H4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 4.3\"\n        title=\"Figure 4.3\"\n        src=\"/CR4-DL/static/160802e4c5430dcd53770df708771861/5754a/figure4-3.png\"\n        srcset=\"/CR4-DL/static/160802e4c5430dcd53770df708771861/63868/figure4-3.png 250w,\n/CR4-DL/static/160802e4c5430dcd53770df708771861/0b533/figure4-3.png 500w,\n/CR4-DL/static/160802e4c5430dcd53770df708771861/5754a/figure4-3.png 613w\"\n        sizes=\"(max-width: 613px) 100vw, 613px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>E.g. Instead of inputting the raw clock face, convert the time into Cartesian coordinates or, even better, into polar coordinates.</li>\n<li>Make the problem easier by expressing it in a simpler way. However, this requires understanding the problem in depth.</li>\n<li>Benefits of feature engineering\n<ul>\n<li>Reduces the amount of resources used</li>\n<li>Reduces the amount of data used</li>\n</ul>\n</li>\n<li>Learning how to deal with overfitting is essential to mastering machine learning.</li>\n<li>The fundamental issue in machine learning is the tension between optimization and generalization.</li>\n<li>The challenge in machine learning is to generalize from the data.</li>\n<li><em>Optimization</em>: adjusting a model to get the best performance.</li>\n<li><em>Generalization</em>: adjusting a model to perform well on any data.</li>\n<li><em>Regularization</em>: adjusting a model to prevent overfitting.</li>\n<li>Regularization methods\n<ul>\n<li>Get more training data</li>\n<li>Reduce the capacity of the network</li>\n<li>Add weight regularization</li>\n<li>Add dropout</li>\n</ul>\n</li>\n<li>Constraining the model\n<ul>\n<li><em>Capacity</em>: the number of learn-able parameters in a model.</li>\n<li>A model with more parameters has a higher learning capacity.</li>\n<li>However, it’ll start overfitting if it has too much room to learn.</li>\n<li>There’s a tradeoff between too much capacity and too little capacity.</li>\n</ul>\n</li>\n<li>The general workflow to find an appropriate model is to start small and to slowly grow the model until you see diminishing returns.</li>\n<li>The larger the model, the quicker it can model the training data but the more susceptible it is to overfitting.</li>\n<li>Simpler models are less likely to overfit than complex ones.</li>\n<li>One way of making the model simpler is to reduce the range of the weights.</li>\n<li><em>Weight regularization</em>: forcing the weights to take only small values.</li>\n<li>Weight regularization penalizes the size of the weights of a network so that large output values that signify strong confidence can no longer be achieved from a single large weight, but instead require several medium-sized weights.</li>\n<li>Conceptually, it penalizes strong opinions from single units and encourages taking into account the opinion of multiple units, thus reducing bias.</li>\n<li>This penalty is added to the error function value thus increasing the error if larger weights are used. As a result, the network is driven to solve the problem with small weights.</li>\n<li>The cost comes in two flavors\n<ul>\n<li><em>L1 regularization</em>: penalizes the absolute size of the weight.</li>\n<li><em>L2 regularization</em>: penalizes the squared size of the weight.</li>\n</ul>\n</li>\n<li>Code implementation of regularizers</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> keras <span class=\"token keyword\">import</span> layers<span class=\"token punctuation\">,</span> models<span class=\"token punctuation\">,</span> regularizers\n\nmodel <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Use L2 regularization with penalty of 0.001 * weight</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> kernel_regularizer<span class=\"token operator\">=</span>regularizers<span class=\"token punctuation\">.</span>l2<span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    activation <span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Use both L1 and L2 regularization</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n    kernel_regularizer<span class=\"token operator\">=</span>regularizers<span class=\"token punctuation\">.</span>l1_l2<span class=\"token punctuation\">(</span>l1<span class=\"token operator\">=</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">,</span> l2<span class=\"token operator\">=</span><span class=\"token number\">0.001</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    activation <span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>The <code class=\"language-text\">l2(0.001))</code> means to use L2 regularization and for every coefficient in the weight matrix of the layer, add <code class=\"language-text\">0.001 * weight_coefficient_value</code> to the total loss of the network.</li>\n<li>Note that this penalty is only added at training and not during testing.</li>\n<li>Another way to prevent overfitting is dropout.</li>\n<li><em>Dropout</em>: randomly dropping out (or setting to zero) a number of output features of the layer during training.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/fd3e581ec7e59564deb8cbf3658b6544/5a190/dropout.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABtUlEQVQoz1WQ3auiQBiH/f+J7oK6aA9EEV10texFYVBBtAfOIpiG5FFz/HodP2bSsWOauahw2H2uhpl55vfOj6vr+tVS17Wu65Ik/bvT0a2rqjqfzwDwfYHrjquqopSKoihJEsa4LMv6f4qiuN1uQRAAQJZl3XPc6/VK0zSKoiAIsizL85wQEkURIeT5fHZaHMeu697vd0pplmVhGGKMGWNNsiiKv1qWy+XPltVqvd1ui6Ko6zrPc1mWFUWxbVvTNISQpml6SyOHYfjx8Wc6nfV6vX6/Px6P9/s9AHRy56dpGsex2YIQYowRQhpZUZTVarVv+f3+vtvtNpvN8Xjsfs4Ys20bAGRZvlwulFJFUQRBQAg1sqqqPM8vFovRaPTj7W06m63Xa0EQuuSiKBhjGGOE0Ol0cl03wFj7/DQMo5F9Hx8Oh/l8PhgMhsPhZDLheR4h9N05IcT3/SRJHMfRdN2yLM/zKKVcVVWW1TRhmtcgCLwWwzBUVX08Ht3Yruuapun7PgBQSgEgDEMA4No+vgDAMHTTRLbj2LbtOG6SJF1sWZae5zmu43merunXK7KQhRBK0/Qv0CgXjDSf9EQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Dropout\"\n        title=\"Dropout\"\n        src=\"/CR4-DL/static/fd3e581ec7e59564deb8cbf3658b6544/5a190/dropout.png\"\n        srcset=\"/CR4-DL/static/fd3e581ec7e59564deb8cbf3658b6544/63868/dropout.png 250w,\n/CR4-DL/static/fd3e581ec7e59564deb8cbf3658b6544/0b533/dropout.png 500w,\n/CR4-DL/static/fd3e581ec7e59564deb8cbf3658b6544/5a190/dropout.png 800w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>E.g. A normal layer returns <code class=\"language-text\">[0.2, 0.5, 1.3, 0.8, 1.1]</code> but a dropout layer would return <code class=\"language-text\">[0, 0.5, 1.3, 0, 1.1]</code>.</li>\n<li><a href=\"https://stats.stackexchange.com/questions/241645/how-to-explain-dropout-regularization-in-simple-terms\">https://stats.stackexchange.com/questions/241645/how-to-explain-dropout-regularization-in-simple-terms</a></li>\n<li><em>Dropout rate</em>: the fraction of features that are zeroed out.</li>\n<li>During testing, no units are dropped out but are instead scaled down by a factor equal to the dropout rate to balance the increased number of active units.</li>\n<li>E.g. <code class=\"language-text\">[0.2, 0.5, 1.3, 0.8, 1.1]</code> with a dropout rate of <code class=\"language-text\">0.2</code> at testing would turn into <code class=\"language-text\">[0, 0.5, 1.3, 0.6, 1.1]</code></li>\n<li>When applying dropout, you need to compensate for the fact that at training time, a portion of the neurons are deactivated. To do so, there are two strategies.\n<ul>\n<li><em>Inverted dropout</em>: divide the output by the dropout rate during training and leave the testing unchanged.</li>\n<li><em>Scaled activation</em>: leave the training unchanged but multiply the output by the dropout rate during testing.</li>\n</ul>\n</li>\n<li>Code implementation of dropout</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">p <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span>  <span class=\"token comment\"># Dropout rate or the probability of keeping a unit active.</span>\n<span class=\"token comment\">## Method 1: Inverted Dropout</span>\n<span class=\"token comment\"># Training: randomly nuke 50% of the output and multiply it by 2</span>\nlayer_output <span class=\"token operator\">*=</span> np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> high<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span>layer_output<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\nlayer_output <span class=\"token operator\">/=</span> p\n<span class=\"token comment\"># Testing: do nothing</span>\n\n<span class=\"token comment\">## Method 2: Scaled Activation</span>\n<span class=\"token comment\"># Training: randomly nuke 50% of the output</span>\nlayer_output <span class=\"token operator\">*=</span> np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> high<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span>layer_output<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Testing: scale output down by 50%</span>\nlayer_output <span class=\"token operator\">*=</span> p</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/225a2481a39cd16605054e10eaa91eea/51800/figure4-8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVQI123O0Y6EIAxAUf//8xxRdCcaKbYFE3QwMsZuYOP7nveb3IqImJ1jh4gppV+RlJLuNDPP8/z+eYtI+U/OuSJE5xwTM/O2bQA2hAAGCKnX/bIsIhJCGMdxXVcAAAPTNBljYowVIj4dMRMdx1FK2fe9VZ21dhqnoR9ExHtf1y+ttWpV0yjVNHX98t5X7pl+ENJ1XaWU+74t2K7thn5g5pxzjNEY47wHAGa+vt/zPD+f+AdOBduXIC9oZwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 4.8\"\n        title=\"Figure 4.8\"\n        src=\"/CR4-DL/static/225a2481a39cd16605054e10eaa91eea/00d43/figure4-8.png\"\n        srcset=\"/CR4-DL/static/225a2481a39cd16605054e10eaa91eea/63868/figure4-8.png 250w,\n/CR4-DL/static/225a2481a39cd16605054e10eaa91eea/0b533/figure4-8.png 500w,\n/CR4-DL/static/225a2481a39cd16605054e10eaa91eea/00d43/figure4-8.png 1000w,\n/CR4-DL/static/225a2481a39cd16605054e10eaa91eea/51800/figure4-8.png 1196w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><a href=\"https://stats.stackexchange.com/questions/241645/how-to-explain-dropout-regularization-in-simple-terms\">https://stats.stackexchange.com/questions/241645/how-to-explain-dropout-regularization-in-simple-terms</a></li>\n<li>Adding dropout to a neural network</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dropout<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dropout<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'sigmoid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>Universal Machine Learning Workflow</strong></p>\n<ol>\n<li>Define the problem and get the data\n<ul>\n<li>What will your input data be? What are you trying to predict? What type of problem are you facing? (binary, multiclass, regression).</li>\n<li>You believe that your outputs can be predicted given your inputs.</li>\n<li>You believe that the input contains sufficient information to predict the output.</li>\n<li>Machine learning can only recognize what it’s already seen. You’re predicting the future given the past.</li>\n</ul>\n</li>\n<li>Choose a measure of success\n<ul>\n<li>Success must be measurable for it to be improvable.</li>\n<li>The metric for success will inform which loss function to choose.</li>\n</ul>\n</li>\n<li>Decide an evaluation protocol\n<ul>\n<li>Once you know what you’re aiming for, you have to figure out how to get there.</li>\n<li>E.g. A validation set, K-fold cross validation.</li>\n</ul>\n</li>\n<li>Prepare your data\n<ul>\n<li>Format the data as tensors.</li>\n<li>Scale the values to be in a small range.</li>\n<li>Normalize features with different ranges.</li>\n<li>Feature engineering.</li>\n</ul>\n</li>\n<li>Develop a model to beat the baseline\n<ul>\n<li>The baseline is random guessing.</li>\n<li>E.g. For guessing digits between 0-9, the baseline is 10% for random guessing.</li>\n<li>The key choices are for the last-layer activation, loss function, and optimization configuration.</li>\n</ul>\n</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/e53fcd161a2fb5f4fcfe1b3fecd2dc17/7a18f/table4-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQY0y2PTUvDMACG+wu9DL0KIn4cBoKoJ0ERxQ/cSRQV9lO8CLq5D1e3oe3c1m1V26VNmjRJF5smUvU5ve/h4eU17u6rzc7bU/Ol+vxSaZiPdfOh3qo0248Ns2Z2n547dbP7UGtVm+1aq1tpmB17MHQ923Gt4cSY3y7Nb5fWj26LJ+WVg+u/Wtg8W96/Kp6UVw9viqflxd2LwuZZYet8ae9y/eh27fB6Yac0t3FstK33rt1vv9r2YOz6wfhrOvGA8+G99oZWfzT+nLp+MPr0e8OxNRj1nInVd6z+6N1xXQ8YEEEaxwRjHEWMUoIxZ0xlinPGKVNKaa2VUum3YJTOkmSWJAlnCeffs5kxBSCKcBiGQRgiCAEIGGNSSoQiQmIppdZKSkkpJYRwzgmJSZwHpdS/HEUYIgQhpJTmO2mKIEzTVP+ilKKUCSHUP1mWZVprw/N9CCFCCAQBAAGCKAxDyhjKiYQQqUyFEL+3cvKDGP8pP1vkZ7/FOF0LAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Table 4.1\"\n        title=\"Table 4.1\"\n        src=\"/CR4-DL/static/e53fcd161a2fb5f4fcfe1b3fecd2dc17/00d43/table4-1.png\"\n        srcset=\"/CR4-DL/static/e53fcd161a2fb5f4fcfe1b3fecd2dc17/63868/table4-1.png 250w,\n/CR4-DL/static/e53fcd161a2fb5f4fcfe1b3fecd2dc17/0b533/table4-1.png 500w,\n/CR4-DL/static/e53fcd161a2fb5f4fcfe1b3fecd2dc17/00d43/table4-1.png 1000w,\n/CR4-DL/static/e53fcd161a2fb5f4fcfe1b3fecd2dc17/7a18f/table4-1.png 1284w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n6. Scale up the model so it overfits</p>\n<ul>\n<li>Once the model is better than the baseline, optimize the model.</li>\n<li>The universal tension in machine learning is between optimization and generalization.</li>\n<li>The model should stand on the border between under-fitting and overfitting; between under-capacity and overcapacity.</li>\n<li>To determine the border, you must first cross it.</li>\n<li>To cross the border, develop a model that overfits by adding more layers, making the layer bigger, and training for more epochs.</li>\n<li>When the validation loss increases, you’ve achieved overfitting.</li>\n</ul>\n<ol start=\"7\">\n<li>Regularize the model and tune the hyperparameters\n<ul>\n<li>Now that the model overfits, move it closer to the border by\n<ul>\n<li>adding dropout</li>\n<li>adding L1/L2 regularization</li>\n<li>modifying the architecture</li>\n<li>modifying the hyperparameters</li>\n</ul>\n</li>\n<li>Be mindful of leaking information from the validation set to the model. You don’t want the hyperparameters to be overspecialized to the validation set.</li>\n<li>Once the neural network looks good, train on both the training and validation set and test it on the testing set.</li>\n</ul>\n</li>\n</ol>\n<p><strong>Summary</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/14aadd4716aed32d75916eb3d2e76baf/9cea8/chapter4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVQoz2VS2a6lIBA8//93N/foUUFkbTaRxeM2TxM08zRJhxSd7lRRxWsgHyqwADKygUn8XfW12/O/ug73Dzwdcx3hJWSPx/dImnFqMWmMRjFQZ3Fwk7fj7EnwNPjJaTw7cl/J7IjV6DzC68/pvEEgP8ERZ5DgrYFBq16Jj1a95B/J27TwkmVJoiS5ZrlmlSOvy1uRGnrBWiU6JTvJWslbThslOpCdNXiZqdXI3QBUH+apSnDjvvnXtipn0DPqDDaAQHSCtRoGJbq08GWmOYoYaAw0RR78tAQ2u7Ey7/ey4K1WvTPYagyyM4Ae8VW/7KxGWvVVjuy8HdPCZ0/O/V42MIDsDfRSdFr1IPv77DQMoHqrkQFkNRKsNYDiwir5PN3MXwDVEfzDWSN5G/yUo0gLz9UekaMoD0giLawkmSKPgcVAK/NWhNPosaQyGOztaNSQF37u9tjsfZpjMw+4jidzc51LdRvEh9NGq8FqBPIJadD1IQhkNU/UCD4GhicUwRrO3lX2sWklPoI1itchSn4ZfVPyK1lTh+ib4J8HTOOPtzjMU6hfZTz2+XXu/lvMmnWtUqtkWLMuSa0ZSoYc1Vr09+6fu7/O+TrDdfjrSn8Bh3yJ8oSLcYUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chapter 4\"\n        title=\"Chapter 4\"\n        src=\"/CR4-DL/static/14aadd4716aed32d75916eb3d2e76baf/00d43/chapter4.png\"\n        srcset=\"/CR4-DL/static/14aadd4716aed32d75916eb3d2e76baf/63868/chapter4.png 250w,\n/CR4-DL/static/14aadd4716aed32d75916eb3d2e76baf/0b533/chapter4.png 500w,\n/CR4-DL/static/14aadd4716aed32d75916eb3d2e76baf/00d43/chapter4.png 1000w,\n/CR4-DL/static/14aadd4716aed32d75916eb3d2e76baf/9cea8/chapter4.png 1278w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1 id=\"part-ii-deep-learning-in-practice\" style=\"position:relative;\"><a href=\"#part-ii-deep-learning-in-practice\" aria-label=\"part ii deep learning in practice permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Part II: Deep Learning in Practice</h1>\n<h2 id=\"chapter-5-deep-learning-for-computer-vision\" style=\"position:relative;\"><a href=\"#chapter-5-deep-learning-for-computer-vision\" aria-label=\"chapter 5 deep learning for computer vision permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 5: Deep learning for computer vision</h2>\n<ul>\n<li><em>Convolutional neural networks (convnets)</em>: a class of neural networks that uses the convolution operation on images for recognition and classification.</li>\n<li>Convnets take in as input tensors of shape <code class=\"language-text\">(image_height, image_width, image_channels)</code> not including the batch dimension.</li>\n<li>Since the output of the conv layer is 3D, we need to flatten it to 1D using it in a dense layer.</li>\n<li>The fundamental difference between dense and convolution layer\n<ul>\n<li>Dense layers learn global patterns in the data.</li>\n<li>Convolution layer learn local patterns in the data.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 892px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/ccbef8774b9097ade51e25a4e08a935a/1568e/figure5-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABl0lEQVQoz43RPWvyUBTA8eMsCOJrwETxBUe3fAGdHQR1EJQI0azWRXFxE1xE/Ah+C3Fzc1CCEIRIr4Xcxz7EJNUhJBi8pQ1dCq39r4cf58ABlmVpmk4mk6nP0ul0Npv1+/2DwYAQ4jgO+TmIRCIA4PF44KtKpZLL5RqNBiHkdrv9himKck0sFstkMhRFLZfLRCLB8/xjHI1GXdztdqvVaqfTGQ6HACAIwmNM07TX6+33+6IojsfjxWIRj8cBoN1u/wmnUqler8fzPFaU7tOTz+cDgFar9RgzDBMKhRiGmUwmHMcBQCAQ+OvZwWAQAMLhcD6fd9m3zfefg3q9Xi6Xa7VasVhsNpulUonjuEKhMJvNHv/ZsqzdbmcYBiFktVodDof1em3btju+Xq+qql4uF9M0Ne2s67rx9qYbH6mqCqfTiWVZQRBEUZzP59vtdjQaTadTF2OMJUlCx5eX43G/3z8/I4SOGGNZluWDDPf7fbPZSJKkqqqmaYSQ8/mMEHKxpmsIIYz/KQpWFOX19b9pmo7jWJZl2/Y7s138tVgGA0gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.1\"\n        title=\"Figure 5.1\"\n        src=\"/CR4-DL/static/ccbef8774b9097ade51e25a4e08a935a/1568e/figure5-1.png\"\n        srcset=\"/CR4-DL/static/ccbef8774b9097ade51e25a4e08a935a/63868/figure5-1.png 250w,\n/CR4-DL/static/ccbef8774b9097ade51e25a4e08a935a/0b533/figure5-1.png 500w,\n/CR4-DL/static/ccbef8774b9097ade51e25a4e08a935a/1568e/figure5-1.png 892w\"\n        sizes=\"(max-width: 892px) 100vw, 892px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Since conv layer learn local patterns, this gives them two interesting properties\n<ul>\n<li>The patterns they learn are translation invariant.</li>\n<li>They can learn spatial hierarchies of patterns.</li>\n</ul>\n</li>\n<li>Convolutions operate over 3D tensors, call feature maps, with two spatial axes (height and width) as well as a depth axis (channels).</li>\n<li>RGB has three channels: red, green, blue. Greyscale has one channel: levels of grey.</li>\n<li>The convolution operation outputs a feature map with an arbitrary depth since the depth axis no longer stands for channels, but rather filters.</li>\n<li><em>Filters</em>: encodes specific aspects of the input data.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/4dfd7ce0945b102b1264da9becc82cb7/d5c6f/figure5-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVQY022PQUvCYACG9zsy6wdUElmdwsJQNCWK+RnhOYS0o5ZopF1Wd0k6DqWD2W9IBTvmSQ8y5voWbmXiNj/ZxPl9FUVQ9Nyf9+GlyG8wxuPxmBCCBgNBeJIk6bXbRQiR/6AghPXH+kOtJrSFyWRimibGmBDyLIrVSrV8X66Uq7Isf+3+BL7lVfuyc30jlUx53W5VUVRNvS0WVVW9KRRmp6ZD+yFAg2QiQQgxTfNv2TY3fxSJMsxF9DDSbDTuSiWXc/M6l8uz7KzFCmgAaHCeznweQWg0Gum6PhwODcPAGFM+j/c4Ftv2+fcCwWazEaQDJ/G41JGuslnHmmNlyT5jsZ6lThFCHMdJnQ6EkOM4nuc1TaP83q1MOkPv7HpcLlVRRFFstVqEkDzLAjoQPggvLtguGUY3jHabf5FlCMW3Xk/p9z/kd6bNDDgKCi7tAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.3\"\n        title=\"Figure 5.3\"\n        src=\"/CR4-DL/static/4dfd7ce0945b102b1264da9becc82cb7/00d43/figure5-3.png\"\n        srcset=\"/CR4-DL/static/4dfd7ce0945b102b1264da9becc82cb7/63868/figure5-3.png 250w,\n/CR4-DL/static/4dfd7ce0945b102b1264da9becc82cb7/0b533/figure5-3.png 500w,\n/CR4-DL/static/4dfd7ce0945b102b1264da9becc82cb7/00d43/figure5-3.png 1000w,\n/CR4-DL/static/4dfd7ce0945b102b1264da9becc82cb7/d5c6f/figure5-3.png 1261w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Convolutions are defined by two key parameters\n<ul>\n<li>Size of the patches extracted from the inputs\n<ul>\n<li>E.g. 3 x 3 or 5 x 5</li>\n</ul>\n</li>\n<li>Depth of the output feature map\n<ul>\n<li>The number of filters computed by the convolution.</li>\n<li>E.g. 32, 64</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 712px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/ee50647245bae6a88e5ee9f4eda1ade1/3d4b6/figure5-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 122%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAIAAAB1KUohAAAACXBIWXMAAAsTAAALEwEAmpwYAAACmElEQVQ4y4VU2XKcMBDc//+oHM9J2a5ynDg+wgJGAqFzdANCKZC9sRPb6QdQQbWmp9WjQ37Cuq4YYcYYxrhpmh5jKcSxOlpry9/8Dw7lZa3daH1/cX7x8cPH87Pz+7u76niklBbauq5CCMYYpVQIKaXcyOUfZ6w+1v0wnJ2d/7z+SQhBCHUPHQCcdAGAUkpKCUqV74e/lCgFXdcxSjfZUqaUXhX8QnZBSinGmHM2xsxPeG5KeoY/ZOds2z40TRNjDCH0fQ8Ay7KMhDDGjLFvGjbP89XV98+fPn/58rVtW4xQXddN04xkQ1VVTdNYa52zhJBh6LsOdV0XYzwUPcfqeHtze3Nzu5WiVEq5Fd/94YyNhExTLE3FELz3IYSU0kHI3XipMO7LkaaUxnH03uecl2UhG3N63bC6bn5cfT9Wdd/3xa2cc9d1IYSybtu22Lb+g0fDjDFN0woucs7TNEkpnXM55xCCEKKoeKUyoww9dEKIy8srhHDOOcbIOTfG5Jy99+M4lo2MtQBgdgCAd+4ghGjqRhtzefntRKaUFnIIgRBSyEpKQkYuBKWUDEQpdXjKrby+viGEFNmcc7uTy0Zvyj6t5nl2zpUwWOfmZSmVp2k6zcbrhp3iqbVOKQFAjNEYc/L8vcrruk7TpJRq25aOI2OMc146fx7vN2Vba/dQtlJKIQTnHAC01uXwd5mPyl+QnXO/7u8BNEJoGIawp89o7b3XANMTmQzbkCOECBkRQt77fTCmqfpVAQDGuO9755yzFpSy1mqtT9lcCtL2mOflhWH7VLYYY++cdw4A7J6Kt4L9eA0VzPMspaSUbtNnrdorG2OW/cz+f5OU3uZ5DmFre1lSfheHLXG7scYYIaVSijIudsO11u+TfwMzUGeMbrfz7AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.4\"\n        title=\"Figure 5.4\"\n        src=\"/CR4-DL/static/ee50647245bae6a88e5ee9f4eda1ade1/3d4b6/figure5-4.png\"\n        srcset=\"/CR4-DL/static/ee50647245bae6a88e5ee9f4eda1ade1/63868/figure5-4.png 250w,\n/CR4-DL/static/ee50647245bae6a88e5ee9f4eda1ade1/0b533/figure5-4.png 500w,\n/CR4-DL/static/ee50647245bae6a88e5ee9f4eda1ade1/3d4b6/figure5-4.png 712w\"\n        sizes=\"(max-width: 712px) 100vw, 712px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>The output width and height may differ from the input width and height due to\n<ul>\n<li>Border effects</li>\n<li>Strides</li>\n</ul>\n</li>\n<li>Border effects and padding\n<ul>\n<li>If you use a sliding window on the raw input, the output will decrease in dimensions due to not being able to use the edge.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/549e113331e91dc33ab8e2db815911bf/0d40b/figure5-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoElEQVQoz3WS25KrIBBF8/+/NjUTFUSdRAE1RkTk4gVjjJ6SzHmZqlkPVL90rd3dnPY/eC5PKWV3IF0hhei0QwghpdJan+Z5ttb+evd9X5aF8zaECIURJRQA6Hk+zgjG5PzlVVV1NBtjmqbhjrZttdZ93x/m55NzjsIojpKiKEOIAh9QQinNfS+43W7GmJMxPUJxEn9HcZIkF2PMPNt939d1VUpRmud50XBOCMWYMNYw1mQZ5rwdx/EkROf7AIIwABBCJIQYx/FtFkIEAQQgxBh7Hvj89NI0S1P88fFVVfcjtlIKgBCFEQwjhGIllbXTu7kTHUIxQjGlOYTI9wEhlBDqecH9Xvd9f8x8vaRZitMU44xoradpesfuuo7SvChKzttfsZuGD8NwbHsYhtFhrZ0cP+auC12cPP8xY3yYz2e/rp15dljHu1iWZd/3x+MhWnG9pNdrWpTl5fsaR0lZlGV5i6OEseaY+a9Psq7r4JimybpI43+MMX3fH9vmnGutW86Zu7aUUhvN6ppzrrRWSrH3oIwJIV6v17ZtL8e2bf8AxrVeVZAclpoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.5\"\n        title=\"Figure 5.5\"\n        src=\"/CR4-DL/static/549e113331e91dc33ab8e2db815911bf/00d43/figure5-5.png\"\n        srcset=\"/CR4-DL/static/549e113331e91dc33ab8e2db815911bf/63868/figure5-5.png 250w,\n/CR4-DL/static/549e113331e91dc33ab8e2db815911bf/0b533/figure5-5.png 500w,\n/CR4-DL/static/549e113331e91dc33ab8e2db815911bf/00d43/figure5-5.png 1000w,\n/CR4-DL/static/549e113331e91dc33ab8e2db815911bf/0d40b/figure5-5.png 1175w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n- To get the output feature map to have the same spatial dimensions as the input, you can use padding.\n- <em>Padding</em>: adding an appropriate number of rows/columns to the input to fit center convolution windows around every input tile.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/4f9555ade44609d06695721633a10aa1/000c7/figure5-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABRklEQVQY0yXR6Y6jMAwAYN7/4arOjkrQllyQwzmcg8AMqqh2Vfj+WIply3a6ELz33p2CD865WmtOeSBEcK6UGp9PrfTz79Nowyil42iMGYZhkrKzxsQY/QkRnXMxxlrrdEJESqk2ehxHayxjbJ7nEALn3AF0WmkAIIT0PeFcAIB3/mfbrl7Lsnjvc87e+1JKCAER6/mYUuoAIITQP/rHo+dcxBMiDidjzP1+pyO93W6U0q/7F+mJmtX3n28hROecw5TEyVqLiBjjtm1Ga6NNSokz7sAxyqy111KttRjj2lo3T5M1Rp8AYJ7n62bTNDHGYoykJ1JO11zHcfw7vV6v4zi6dV2XWmspbfkopez7viyLlFIIgYiEEKUUIURK+X6/r+LW2r7v3ecSubR1BbAppZ/f38+fxRgu3l8R7CdbSjHW5pyvFv8BXMqzOcFlZEUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.6\"\n        title=\"Figure 5.6\"\n        src=\"/CR4-DL/static/4f9555ade44609d06695721633a10aa1/00d43/figure5-6.png\"\n        srcset=\"/CR4-DL/static/4f9555ade44609d06695721633a10aa1/63868/figure5-6.png 250w,\n/CR4-DL/static/4f9555ade44609d06695721633a10aa1/0b533/figure5-6.png 500w,\n/CR4-DL/static/4f9555ade44609d06695721633a10aa1/00d43/figure5-6.png 1000w,\n/CR4-DL/static/4f9555ade44609d06695721633a10aa1/000c7/figure5-6.png 1137w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n- There are two padding arguments in Keras\n- <em>Valid</em>: no padding (only valid window locations are used).\n- <em>Same</em>: pad so that the output will have the same dimensions as the input.</p>\n<ul>\n<li><em>Stride</em>: the distance between two successive windows.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/ad5dd4d026408ff55f1480f199f8aca6/74d4e/figure5-7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfklEQVQoz02R6XakIBBGff/Xm5y4dgsqiB2gZV9UnFGSObk/oS5V9VG4X3jv7Y33ftu28zy11lJKY4zOKG2tNcYopay1Rb67Doxx3ue6EIIx5jxPY4yUEl3g1+tFKZvnZYADpXTbtkIpJaXsewDhgPH86B7TOMUYrbVZ5pxXVV2VNYTDPM9t0378+UAIxRgveV3Xtu267gEArKqr6L/svVdKTROCcCRkoZSOIxqGkTG27/u33Pfg+ewhHJ7PHiEUQvgtc84ZY0JcC7IbIYRz7pKFEGVZNU0HACw/KwBAjDHvrLVmjHXdo66bYRjnmbRt19QNxth7f8lKqmmaMMZfX69xHAkheeyUknNOCFE3Tdt204SWZel7UJYVIctxHIUQQuvvD/A/aTvnjDEppZw2uVgoZZxzShnGM2M8hFCklI7j2LZt3/fjh5TSeeO9DyHEOwLnnLU2hJCfvsZmlL7f7xC8sUYKwTh/v1fG+LqunHOlFCFkXdf9JrfJnf6l/ResjDF/A4yCOQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.7\"\n        title=\"Figure 5.7\"\n        src=\"/CR4-DL/static/ad5dd4d026408ff55f1480f199f8aca6/00d43/figure5-7.png\"\n        srcset=\"/CR4-DL/static/ad5dd4d026408ff55f1480f199f8aca6/63868/figure5-7.png 250w,\n/CR4-DL/static/ad5dd4d026408ff55f1480f199f8aca6/0b533/figure5-7.png 500w,\n/CR4-DL/static/ad5dd4d026408ff55f1480f199f8aca6/00d43/figure5-7.png 1000w,\n/CR4-DL/static/ad5dd4d026408ff55f1480f199f8aca6/74d4e/figure5-7.png 1157w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Stride can be used to downsample a feature map however, max-pooling is more commonly used.</li>\n<li>The role of max pooling is to aggressively downsample feature maps.</li>\n<li><em>Max pooling</em>: extracting windows from the input feature maps and outputting the max value of each channel.</li>\n<li>It’s similar to convolution but instead of transforming local patches using the convolution kernel, they’re transformed using the max tensor operation.</li>\n<li>Max pooling is typically done with 2 x 2 windows and stride 2.</li>\n<li>Use max pooling to\n<ul>\n<li>Learn a spatial hierarchy of features.</li>\n<li>Reduce the final feature map over time instead of all at the end to reduce overfitting.</li>\n</ul>\n</li>\n<li>Alternatives to max pooling\n<ul>\n<li>Strides</li>\n<li>Average pooling</li>\n</ul>\n</li>\n<li>The depth of feature maps progressively increases whereas the size of the feature maps decreases. This is a common pattern in almost all convnets.</li>\n<li>Data preprocessing steps for images\n<ol>\n<li>Read the picture file.</li>\n<li>Decode the JPEG into RGB grids of pixels.</li>\n<li>Convert these to floating-point tensors.</li>\n<li>Rescale the pixel values from between 0 and 255 to between 0 and 1.</li>\n</ol>\n</li>\n<li>To fit a model to a generator instead of an array of tensors, use <code class=\"language-text\">fit_generator()</code> instead of <code class=\"language-text\">fit()</code>.</li>\n<li>Since the data is being generated endlessly, use the <code class=\"language-text\">steps_per_epoch</code> argument to set the number of batches to draw per epoch.</li>\n<li>Use data augmentation to generate more training data from existing samples to prevent overfitting.</li>\n<li><em>Data augmentation</em>: augmenting the training samples by using random transformations.</li>\n<li>Keras supports\n<ul>\n<li>Rotation</li>\n<li>Translation</li>\n<li>Shear</li>\n<li>Zoom</li>\n<li>Flip</li>\n</ul>\n</li>\n<li><em>Pretrained network</em>: a saved network that was previously trained on a large dataset.</li>\n<li>The two ways to use a pretrained network\n<ul>\n<li>Feature extraction</li>\n<li>Fine-tuning</li>\n</ul>\n</li>\n<li><em>Feature extraction</em>: using representations learned by a previous network to extract interesting features from new samples.</li>\n<li>Convnets consist of two parts\n<ul>\n<li>the pooling and convolution layers (called the convolution base)</li>\n<li>the dense layers</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/9133aabd99295075e128c9b46d7f36d3/1be7e/figure5-14.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1ElEQVQoz6WSW2/cIBCF/f//VZrLa9NIVaRmL77sGrDJjgEzXGw8rU272lZRXvo9IHTgcDkzBRE5586nc9/1dMMUp/bccsbTslzFlJIQgjM+z4mICu99jBEAtNZhg4iUUoiohhVrrTGGiIwxAMAZZy2DC2ilixijc+71+2tdN0Q0jiMRaa2HYfj29fnl+cUiaq2JqKmbp8enx4en+7v7L3cPu92+QGvtOLKWSSkR0TlHRACgBsUZE5yrQSmliEhKWVf18Xgsy7IqK8Z4gYjeub7rACCEgIj5fu/9u5TvUsYYrLVrNIhpnuFykVJO04SIxTRNozFvP97KsspfWJbFOWetPR4O+93Bbawiog+hqZv9bq+18d6v5pQS51xrvWzJExEippRk318AUkpZ3I5ITd2Ux3KeZ+fcar6tkDFGa50/eWUcR601ABCR9+76ut/m5U8xrbUxxpz5h+KVD27OgeXxc/G/zSGEZVnmjZRS3mGtTSldxVyqnOLtzrU9vfdd1wNAbtUtFe9DkP1a53W29WxuXiml7OW2Hor8BjVo7z39zWisQ/eP6Jy/Jle0bStEBzAAQFVVbdtyzk7nU7ciOOdVVUsphRB933POGWNCiK7rfpl/Ar/0XZ6DbgQrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.14\"\n        title=\"Figure 5.14\"\n        src=\"/CR4-DL/static/9133aabd99295075e128c9b46d7f36d3/00d43/figure5-14.png\"\n        srcset=\"/CR4-DL/static/9133aabd99295075e128c9b46d7f36d3/63868/figure5-14.png 250w,\n/CR4-DL/static/9133aabd99295075e128c9b46d7f36d3/0b533/figure5-14.png 500w,\n/CR4-DL/static/9133aabd99295075e128c9b46d7f36d3/00d43/figure5-14.png 1000w,\n/CR4-DL/static/9133aabd99295075e128c9b46d7f36d3/1be7e/figure5-14.png 1059w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>The reason to discard the classifier is because the representations learned by the convolution base are more general and thus more reusable.</li>\n<li>The more general a model is, the more reusable it is.</li>\n<li>After getting a pretrained network, there are two ways you can proceed\n<ul>\n<li>Running the conv base on your dataset and storing the result on disk. Then feeding the results into dense layers. This is fast and cheap but can’t use data augmentation since the conv base is only run once per image.</li>\n<li>Extending the pretrained network by adding dense layers on top. Can use data augmentation since the image goes through the conv base every time it’s seen by the model.</li>\n</ul>\n</li>\n<li>In Keras, models behave just like layers which means you can do something like this: <code class=\"language-text\">model.add(conv_base)</code>.</li>\n<li><em>Freezing</em>: preventing a layer’s weights from updating.</li>\n<li>Always recompile the model after freezing layers.</li>\n<li><em>Fine-tuning</em>: unfreezing a few of the top layers of a frozen model and training the thawed layers along with the classifier.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 515px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/fdf8d9ccad415d0613fcd6641f15b987/fbdcb/figure5-19.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 166.79999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAIAAABWXBxEAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC50lEQVQ4y5WUSZObSBCF+f8/wEfHzMVzcsyhIzrsGNsjtxYQSCC1WKqKKnYQkmgQqyQ2TUBPzHFcehdOr8j8MvMxaxKuoD0V1aWMeeRVdXu/3/s7lZglDgXozDaQUwwOBW9pnsRxFMVlWf7azONQQO50AznV5JCfVddwv4dQv1xvFGYScjJht4jb6Rzyy7Hsruuoyl7p3mxnTNbabEcWqnWpmzu1GAGHInLmkiYoZIn86vYIMB6Ha+QutohXDF4PTufseAg9z0/TlIK2HvKaPZPAUjEXwCtvTRydDMOsm/bXZsk4bDRDVLCkkTUOHpwz9F5k65ugTrZkqliXW3Pv+7Zt+76n6FkPNtDkNtpawUvolg8BE8gAbL6BgjoAS7KyyLPknFZlRUVbHGgP5iUKznnlOrYsq3lR0K3nuNu8arLQ/xdYT1U4szZCUSWrHRJVvNL98taMZio/s8IBC/2XLV6oDgvcy2juup6W9ko1Zmtl+YpY4DxGmx9oO/Ox5wFYUV3KsiiK6+VKdxjQWWzRQHsclWPbO1nJ8pxqzuL4Z0EzuZF233U13WEynB5yOzKXAPeKWeAX7z1T0ga2pRJdVGQZQ4Xg20NhEJ/A3ocYbV1LO4Va171zoluS6Ag8V4VANMnusFeburpd67q+tS3FPb8dtcAHGG0sU46OIH47KIoGAHAcj8J80gJfQ1CyLfkYqvWtrKrLMGea6I1P0LU0gnYWUU/7B3sm9nqjTYTtd1GZAMI2zSPmL9qnuf68lKYC+fkkf8yrrKmbtm1pcp/5Cj69oCdW+snCb8/gt+Dg7bayJErEsP7nsPtRzF/wjzl+5rZTHv/9rP2eFWesE4FfvcXJ/X5vmiEJu64bSmnfP91/LzJPrx9/KH/OxclM/fpZ+lBe8zwroijq+j7PMqRjy7KDwDct2zQGIR0Fwb4oirIsmSCxnYi4R9M9GV5M2m5MkhFY0zTJOUmSJB2VjTqfz2maxkmcZfk/3i1QCtLh33UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.19\"\n        title=\"Figure 5.19\"\n        src=\"/CR4-DL/static/fdf8d9ccad415d0613fcd6641f15b987/fbdcb/figure5-19.png\"\n        srcset=\"/CR4-DL/static/fdf8d9ccad415d0613fcd6641f15b987/63868/figure5-19.png 250w,\n/CR4-DL/static/fdf8d9ccad415d0613fcd6641f15b987/0b533/figure5-19.png 500w,\n/CR4-DL/static/fdf8d9ccad415d0613fcd6641f15b987/fbdcb/figure5-19.png 515w\"\n        sizes=\"(max-width: 515px) 100vw, 515px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Steps for fine-tuning a network\n<ol>\n<li>Add your custom network on top of the pre-trained base network.</li>\n<li>Freeze the base network.</li>\n<li>Train your custom network.</li>\n<li>Unfreeze some layers in the base network.</li>\n<li>Jointly train both the unfrozen layer and your custom network.</li>\n</ol>\n</li>\n<li>Three ways of visualizing what a convnet learn\n<ul>\n<li><em>Intermediate activations</em>: for understanding how convnet layers transform their input.</li>\n<li><em>Convnet filters</em>: for understanding what visual patterns/concepts each filter is receptive to.</li>\n<li><em>Heatmaps of class activation</em>: for understanding which parts of an image lead to the activation of that neuron.</li>\n</ul>\n</li>\n<li>To grab the intermediate activations from a model for certain inputs, use the following code.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> keras <span class=\"token keyword\">import</span> models\n\n<span class=\"token comment\"># Extract the outputs of the top eight layers</span>\nlayer_outputs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>layer<span class=\"token punctuation\">.</span>output <span class=\"token keyword\">for</span> layer <span class=\"token keyword\">in</span> model<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\nactivation_model <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">(</span>\n    inputs<span class=\"token operator\">=</span>model<span class=\"token punctuation\">.</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">,</span> outputs<span class=\"token operator\">=</span>layer_outputs<span class=\"token punctuation\">)</span>\nactivations <span class=\"token operator\">=</span> activation_model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>img_tensor<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>Interesting notes from displaying the activations\n<ul>\n<li>The first layer acts like an edge detector.</li>\n<li>The higher you go, the more the abstract the activations become.</li>\n<li>The higher you go, the more sparse the activations hence why some of the filters are blank. This means the pattern encoded by the filter isn’t found in the input image.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/16d32730c82910245f89b7ab191a33cf/c56af/figure5-25.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.599999999999994%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbElEQVQoz43Oy0oCcRQG8KPjaBeLgqCXKIlKN4KCc/7OEIk11yayiy6zCHoIq9dwVl3EVVDkpVy1aGEQeGN8Alu0sRzHCW0t08fh7H58H7wW3oq5l1K+Usg9l/KVp7vy43Xx6a58rz00P1qWZQ3MgTUmsL9yGnQI6BQYiEdgixldlJbXgc1mbizLMnr9sfjQlw7SEpk9QAePwDPAM5TIetR12Mhe3drh5XQIeHbuEGkFHeLwz+xzbtUPm9lLO5z0nYQcEvEm0CkS4MmkigtJbv4oAJua/eyl4zDEiVclsI2UjC4FPTusNxGAqJa5tm8OQyy6uIduBSkJp3ZxQubckh+IfXPqD1MioaQhphUCPOeSAv/Cq2chiLHAR2Z3mOnReBA4lxwAVrsY4u/uj2mahmH0+31jFNM0e71et9uF1Np5CGJRp4hOASkRQRg204p/hD+/Ou/Vqq7rervdaDRqtXqz1azX62293el0fgGAN4EaH4+lFQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.25\"\n        title=\"Figure 5.25\"\n        src=\"/CR4-DL/static/16d32730c82910245f89b7ab191a33cf/00d43/figure5-25.png\"\n        srcset=\"/CR4-DL/static/16d32730c82910245f89b7ab191a33cf/63868/figure5-25.png 250w,\n/CR4-DL/static/16d32730c82910245f89b7ab191a33cf/0b533/figure5-25.png 500w,\n/CR4-DL/static/16d32730c82910245f89b7ab191a33cf/00d43/figure5-25.png 1000w,\n/CR4-DL/static/16d32730c82910245f89b7ab191a33cf/c56af/figure5-25.png 1231w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>This channels appears to encode a diagonal edge detector.</li>\n<li>Gradient ascent in input space: applying gradient descent to the input of a convnet to maximize the response of a specific filter.</li>\n<li>Implementing gradient ascent in the input space\n<ul>\n<li>Build a loss function that maximizes the value of a given filter in a given layer.</li>\n<li>Use SGD to adjust the values of the input to maximize the activation value.</li>\n</ul>\n</li>\n<li>Similar to the activations, the filters get more abstract the deeper into the network we go.</li>\n<li><em>Class activation heatmap (CAM)</em>: a 2D grid of scores associated with a specific output class, computed for every location in any input image, indicating how important each location is with respect to the class under consideration.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/70e847280f91c6e709957a81bad99c37/e3189/figure5-36.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAADT0lEQVQozy3NW0xbdRwH8PO0pyWLD2YPZjFZ3B58dGZve9DtQXGLyXQh2Q11ImNYCr333Fp62tPr6Y0OOiiVbtFuGAJuAolkFrKBtAd6OeCQUmjL1nPa064YZTUU+P9Np8k3v3zzTT75Ic+2YDILU3nA5SHXuGB5C3BbYDkPl//rOchlAZeFyU2QyID4Goz9DhJpsLcPkXgWLqQhm2kklvm/LGYgu36Q2ASLaZDIwWUBJp83Es/BWBpGV+E8B+p7EEnmGmbxtYxtQHYDsusglYMTkfLo9NbGHpz/A4zMvgxOFELhFwODmwrlY/936UQG7tYBwuUbcqnxCiytHbCrMJqG0QKcLwNsfHbgWbLNOXHmckBK/3ah5f6ps773T/tOnLSFHuQghAiXqrKxl+xCJbm0E1+HK3/up+uVTVAswCpXnhuf0/WFP/+6v6X5vv0Yir5xHn/ruPrw4db29tEGTkVXYzNJdoZ/NFdcEaO5J571URW/oIjwY/7F2fzf+T1YDEQmj16Uvt2kO3ZcdvTN5kOHPjj/CdbA7Hwy8svTmcm1ETYbXzE/oT6awpq6FO+9i6qPfGhk7iW4KpRrHn/aZD93hnRYxlH87jsnbpw9112t/oX89PDRyMiP4e9HQw/mJnKr8YNf/anQZ2HPhYE7Jz82SvAx7/DTi5ecrRL95Raqh54yuyLNV4YlXT9sb79Cbg8O6a12E+N2+QKU/S7ZP37dMCYLTloeTl+Vha9cD8g1t1E9Y2a8zt5+xnOvzz/l6v15MDhd391H+oZCUtKgNts7Sd1NtaJTQ8owRkEMqvXDCqIfN/ca3S6dzWpyujDapDQYcbMDN9g8vsDubh25EwzSHhfldqktRrlJp7b1qGx6mYnAHGbUQWvslNpKd+D4Nypth1Z3S0PISEqroxi3r1arISYH04URrTLVDXm3tIdox5QdeqVEr+00aL/VKzsI/KYa/apbek3S+aUEbbmlvdqm+qJNrkLpnZ1XiGdgiLDZUYulx8mgtL2b1FEeRmdnMLPVwHgph19JWmWEAaNthMlNGN0q0kqZvW7vUK32DyIIglgWS6VSdXu7UHjB87wgCMWSKIpiuVwRBIEXBFEUeZ4vVyqvx3KB50VRLJWK/wIrDzGX0ZG3DwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 5.36\"\n        title=\"Figure 5.36\"\n        src=\"/CR4-DL/static/70e847280f91c6e709957a81bad99c37/00d43/figure5-36.png\"\n        srcset=\"/CR4-DL/static/70e847280f91c6e709957a81bad99c37/63868/figure5-36.png 250w,\n/CR4-DL/static/70e847280f91c6e709957a81bad99c37/0b533/figure5-36.png 500w,\n/CR4-DL/static/70e847280f91c6e709957a81bad99c37/00d43/figure5-36.png 1000w,\n/CR4-DL/static/70e847280f91c6e709957a81bad99c37/e3189/figure5-36.png 1035w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>You’re weighting a spatial map of “how intensely the input image activates different channels” by “how important each channel is with regard to the class”, resulting in a spatial map of “how intensely the input image activates the class.”</li>\n</ul>\n<p><strong>Summary</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/02e592c404cd9b089958e790aba281ad/9cea8/chapter5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.599999999999994%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABtUlEQVQoz1VS6c6jMAzk/V+vWyCcuZwDcgdK+283pJ/0rWRZTqTx2DNujKHD0mM2cjEvZGBieb/0r9j+f37jOtV1qiZF4IBW0mLSrbhdcWu2xWyz2Zddz5uadj3vetZyVGK0+7qpSYnxSPB+6eb90p8DdjVJQLueFCDgPaedBCRgANZJMQjec9YJjgRHUgwSSg6ONtepzgybmgRHSg4KBiVGAUjw/khwJFFzTpATHLkUZxYp8COJL1jwXgJi5MlpW+vgiLM4eOotjp7afXEGO0vsvnpHgyMpsAJ+ZZCAlBi0HIF1nLZajs6s3pLgqHekNDI4OOItcYZER53BR4KbOfGKIfjPujw47fDyIOvDW+wtuTN2Bt9IXLs4s+ZYwPpM7NZwKNoA0mra1KTVpOW43SJLQKXW8y3qrOQgOTqzbK6XPiITvAfWVTPsvjpTLNFyqoaZfakmVdvMtmxqcpYU5iMxJQZ10+bIU2DBkuhpCqyOWteuykVfPqOnPzvfggHrGW0pfgLr8Pqg+KnF6Ku8ZecyUShd6L0/zpE39dAqYeH0NEdIoTyPBJ/re56fq8S3vuPfef4FkbiM74i5uBAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chapter 5\"\n        title=\"Chapter 5\"\n        src=\"/CR4-DL/static/02e592c404cd9b089958e790aba281ad/00d43/chapter5.png\"\n        srcset=\"/CR4-DL/static/02e592c404cd9b089958e790aba281ad/63868/chapter5.png 250w,\n/CR4-DL/static/02e592c404cd9b089958e790aba281ad/0b533/chapter5.png 500w,\n/CR4-DL/static/02e592c404cd9b089958e790aba281ad/00d43/chapter5.png 1000w,\n/CR4-DL/static/02e592c404cd9b089958e790aba281ad/9cea8/chapter5.png 1278w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"chapter-6-deep-learning-for-text-and-sequences\" style=\"position:relative;\"><a href=\"#chapter-6-deep-learning-for-text-and-sequences\" aria-label=\"chapter 6 deep learning for text and sequences permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 6: Deep learning for text and sequences</h2>\n<ul>\n<li>None of the deep learning models in this chapter understand text in the human sense.</li>\n<li>Rather, these models can map the statistical structure of written language.</li>\n<li>Deep learning for natural language processing is pattern recognition applied to words, sentences, and paragraphs.</li>\n<li><em>Vectorizing text</em>: the processing of transforming text into vectors/tensors.</li>\n<li>Vectorize text in multiple ways\n<ul>\n<li>Segment text into words and transform each word into a vector.</li>\n<li>Segment text into characters and transform each character into a vector.</li>\n<li>Extract n-grams of words/characters and transform each n-gram into a vector.</li>\n</ul>\n</li>\n<li><em>N-grams</em>: overlapping groups of multiple consecutive words/characters.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 852px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/27236f88ac2ddd4c984e481829c3a628/47ff6/n-grams.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.60000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAADDklEQVQ4y01TaY+jOBTk//+q7c5BkgaMj4CNT24wZybdOebTrpPVaKQSerJ4r6rsel7TqkwmXKVUpKbkTLmv0JRrKgw1JX/c+vtPd/tub9/dX7WD1zYZoxFjQAiYJkHGgFZY8JhRIAXMMiA4MAorAaWAuSZaQsFjrfBlKb3RSq1QVSR1keYKF4YUhhiFc00Kc9YSKQlzQ5SAWqFcYaNwmZ+VgNe18pqasjTgNKRJwFnE0pClQZp8SQETfJQ8vl6qZdDjoOfJTINe52JdCtuJ66X2vi/10Itlyier1jm/LMU06Mta9q24XsrRqstSvq0+7/Z5t49b/7j1z4crvMtatjVra2Zb0TVZW7O6on3Lm4q2NSvzc9fytqJ1Sb+vzd+3df/pvHk0VZn2nXiPaGvWt7z/M6iktpdN7Qb9XF3DG/83377btmbToOuSToMeejkOarSqLtNp0K4o0qGX65xfL9Uf2W9461y8efo26xuntnYi067ho1VlkZRFYjsxj9p2Yhr0PJr30F9r6RWGxNEWowNNvkC4IciHYIdiH0RbEG5gvCfIR/EeRNs42oZfnxj5BPpxtBut9vo2S8hJZECKWAm4TPk658tkptGRuNpRmXnKlzkfB7VMZn7xvxJWs4xGIgMiAzyLc02qMjUaawmVRPoFzsG7MBLn2uVPCehkd03Gs0hLLHnMmZviwuSChVgaSB7TNMxoyGjoOBiQPBYcZCxa58KriwSE2yjcQLB7uXUmo+ATQz84fRB8hGCL4J7gw9t2cPqIwQ5Df7Daq4oEwj2Cewz9BB/PLxB0SM4njA5nciDYIT2fEnLC0J2/fvCXufBsJ7I0VMI5dNsjYUbD9z6kaaAlEhzwDGgJMxYZhco8ebmL3VaVRQLBLvj6OJMTCDdONj4m+IihHwafBB2icIPRISHH+PV4GB0w8oOvf+bReE1FUbyD8Y5gdwpjp99ZIE4nwYfY3cXe7bCAToJCL3WRa/61lkMv3atOxnZi7JXthO1dmN5JGq2aBv249b8f9vfDPu/98zE87/a/bP8L+ZrbO3EGvBwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Understanding n-grams and bag-of-words\"\n        title=\"Understanding n-grams and bag-of-words\"\n        src=\"/CR4-DL/static/27236f88ac2ddd4c984e481829c3a628/47ff6/n-grams.png\"\n        srcset=\"/CR4-DL/static/27236f88ac2ddd4c984e481829c3a628/63868/n-grams.png 250w,\n/CR4-DL/static/27236f88ac2ddd4c984e481829c3a628/0b533/n-grams.png 500w,\n/CR4-DL/static/27236f88ac2ddd4c984e481829c3a628/47ff6/n-grams.png 852w\"\n        sizes=\"(max-width: 852px) 100vw, 852px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><em>Tokens</em>: the different units you can break down text (characters, words, n-grams).</li>\n<li><em>Tokenization</em>: breaking text into tokens.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 804px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/97d9170c07656e19517eb5e2700206bf/27b7a/figure6-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPUlEQVQoz4WPbW+EIBCE/f8/8XLVKqggsMAuL3JWbTjTL03vOiFkQvZhZ5rzPEspiEhEOed5nvu+DxQCUYwpxni+VnOe5+PxQEQhpRBi5KMQUszzNE7Xd//Ax3Gs61qeyjkDwLZt61P7vr+DY4yImH7EGOvaLsbqc85XnWvBH3AIYZ5mRAIDYGDknA1cLcp5v8iFKLyDSynOOSJC7wmrtNYxBkT0Hp1zb2o3RJRScs5574lIKcUY895bW19iSiGEV80ba+26rpxzzurpP/unYZzzoR9ijNbafd+P43fy4zgarZQ2Bj2CAa00GAMWAMA5Z60FY8Zxehm7TgNcc8YYW129tNZqWbx3Ui5f2zb0vZTSaJ1TmoXQWksp6+aLAQNKqat8jQBGSllKIcRS1rb9uN1uXdeqRXVdd7/fAeAbgZB2BKmZ9igAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.1\"\n        title=\"Figure 6.1\"\n        src=\"/CR4-DL/static/97d9170c07656e19517eb5e2700206bf/27b7a/figure6-1.png\"\n        srcset=\"/CR4-DL/static/97d9170c07656e19517eb5e2700206bf/63868/figure6-1.png 250w,\n/CR4-DL/static/97d9170c07656e19517eb5e2700206bf/0b533/figure6-1.png 500w,\n/CR4-DL/static/97d9170c07656e19517eb5e2700206bf/27b7a/figure6-1.png 804w\"\n        sizes=\"(max-width: 804px) 100vw, 804px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>There are multiple ways of associating a vector with a token\n<ul>\n<li><em>One-hot encoding</em>: associating a unique integer index to each unique word.</li>\n<li><em>Word embedding</em>: associating a vector to a word.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/7660e7e4a367d960800c7a68eadbeb53/669eb/figure6-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVQoz5WS20oCURSG5+mKqEQqui0tMQtKkiQSFclM6QE80U2IFtVV+gRpL1BBxRz37Gbv0e2YBxyFGXfkkBjRwe/yh2/9i8ViErHY8uLSaTbb6/UopYPBgP4b5vryasFu927vaJo2sZyIx+3zti2Pp1arjeTBJ3/IJ4nEns+35nBo9frEzZFQeN3h3Pf7VVUddZZvy4V84f7h8fdxTDAQcK6shoMhjLEVIQWlkqmjw+jF+QWl1DCMH+VoJGKbndt0bxBCrKharebz+eJN8a5SoZSapjkujC/CBA8CM1PTbpfLOhilFEKYSqbSyUypWPouf2nOpjO7Xu9xLNZoNKyo3e6UiqXcWe7p+cU0DQAAIQSrKlKQijEaAl9hp9NhEEIYq5rWaLValqzrOoRQxbjb7eq6znOcIIgAACBJMoQcx0lDZFlmkKJwLEcIsT7MkgVBVD6G4rdmk+d5lmWBLIuiKElAFAUAQL/fNwzjHeKCR89qHSIUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.2\"\n        title=\"Figure 6.2\"\n        src=\"/CR4-DL/static/7660e7e4a367d960800c7a68eadbeb53/00d43/figure6-2.png\"\n        srcset=\"/CR4-DL/static/7660e7e4a367d960800c7a68eadbeb53/63868/figure6-2.png 250w,\n/CR4-DL/static/7660e7e4a367d960800c7a68eadbeb53/0b533/figure6-2.png 500w,\n/CR4-DL/static/7660e7e4a367d960800c7a68eadbeb53/00d43/figure6-2.png 1000w,\n/CR4-DL/static/7660e7e4a367d960800c7a68eadbeb53/669eb/figure6-2.png 1244w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Two ways to obtain word embeddings\n<ul>\n<li>Learn word embeddings jointly with the main task.</li>\n<li>Load into your model word embeddings that were precomputed on a different task.</li>\n</ul>\n</li>\n<li>The geometric relationship between word vectors should reflect the semantic relationship between those words.</li>\n<li>Word embeddings are meant to map human language into a geometric space with words closer in meaning mapped closer together and specific directions to be meaningful.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 351px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/0bfb3c59ca953daa8a6d2de7b02570a3/7c2a6/figure6-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 124%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsTAAALEwEAmpwYAAACPElEQVQ4y51Te1PiMBzs9/82zvgo9RAVPSkoz+OUo4RCadN32qZN+kpzI5wMKp7o/tV0sr/d2d9G4JwHQdC6a3HOq6riX4GwId/e3HyTTAh5enzcnKsXHETOs7woCk3T/nNpO+vNXME0zKIooWFwzhljs6myXCzmqopQQCn9RLmqKsaYoevPgxlTlNmg159OFR8FGOPNpSAIfNeezmarlW7b9lZc2Agaa+WPDDuOQ+JoMlWa17fLpfYqsF0ye8Ehsb0l7027eo0PyV/e8y7ZNi3DgFEUYRxnWfY1Mpgq3Yfuw31XVRdRFG0zqyr2PoL9thkrt9+EEE3TLBO2Zfn3+Gm3M3sCY4ztlqksyzRN8zxHCGEc71HW1yX5TmBlWVqWxRgrP0NRFFmWFUWxcSeAGXAcp9fru66n67rxMSCEAABFUer1eq/bfSaHYZimqWVZh/jM8xxjnOf5ZovPtjOaADAvD3jCKaWu424DF6p1jbdlftlq9aaV73/+U/42hDkAugF93/c8D+PINE3k+67ncc4hhAghy7LwGj7yEUKO4/jI11c6IUQYjYa1mnj+o97udAAAo9FwMpkosznnvNd9WK1WLVnu9wfqfN7u3N+1ZFmWm81m4+JCXSwFShIIYRwnlBCM4ySJbdtOSBJFked5YRgFAVJV1fX8JEkooYSQMAwJSSilws/bm8Ho13g8Hg6HYk26bDSurq7bnc5lo3F2diqKoiSKR0dHpzXp5Ph4MvlzcnwiSdL5udRqd/4CX6mZ2qYiRXQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.3\"\n        title=\"Figure 6.3\"\n        src=\"/CR4-DL/static/0bfb3c59ca953daa8a6d2de7b02570a3/7c2a6/figure6-3.png\"\n        srcset=\"/CR4-DL/static/0bfb3c59ca953daa8a6d2de7b02570a3/63868/figure6-3.png 250w,\n/CR4-DL/static/0bfb3c59ca953daa8a6d2de7b02570a3/7c2a6/figure6-3.png 351w\"\n        sizes=\"(max-width: 351px) 100vw, 351px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>The transformation “from pet to wild animal” goes from bottom to top.</li>\n<li>The transformation “from canine to feline” goes from left to right.</li>\n<li>Learn the embeddings using backprop.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>layers <span class=\"token keyword\">import</span> Embedding\n\n<span class=\"token comment\"># The 1000 is the number of possible tokens (1 + maximum word index).</span>\n<span class=\"token comment\"># The 64 is the dimensionality of the embeddings.</span>\nembedding_layer <span class=\"token operator\">=</span> Embedding<span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>Think of the embedding layer as a dictionary that maps words to vectors.</li>\n<li>Word index → Embedding layer → Corresponding word vector.</li>\n<li>The embedding layer takes a 2D tensor of shape <code class=\"language-text\">(samples, sequence_length)</code> and returns a 3D tensor of shape <code class=\"language-text\">(samples, sequence_length, embedding_dimensionality</code>.</li>\n<li>All sequences in a batch must have the same length so pad the shorter ones and chop the longer ones.</li>\n<li>Use pretrained word embeddings when you don’t have a lot of data.</li>\n<li><em>Recurrent neural network (RNN)</em>: a class of neural network that maintains previously seen information; a network with memory.</li>\n<li>RNNs feed their previous output alongside the current input.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/27ce2283356d84c7cff828e09165b761/d72ec/figure6-9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.60000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMElEQVQ4y42TfXOiMBDG+f6fyhmv6p12IpIi76IESEIT5M0EUXJjsdr2vE5/wx/MJs/uzrMbTf0A27Jd17VME76Ya3N9OIghrn0v6/teKQUNI89zQshuF2GMu2N3Ffd9f/6Wvu+zLBuyfEHbBAEhBP8DJWT4CMa+7z/sS8MY39r7yOnG+YyiqG3b4zu3yxol5KN4+GGvr9Ful1FKCWGMEUJYllFCMkpjhG4SLUaobdvD4SDekFLWdb0JAiHEcCPnvCzKujkMeVsp72IUXQwciqRpSin1PO/3bCalVEod2xbqy/FovFgA+WayFDKj9CpeQwgN6AeBZTuW7XiWo5R6zbKmaR6aJKUk7zZpxX6PEArDbZKk2+0uQpEQoixLhNDF6TTFGBurVZoklxkQEsdxURRXcbQN12vbthzXdaHxYpprxvhwNqyAUmryNOm6rr/G7nPRvlmsG5clOd+V91H1j/iSK03Txxv2k4dBCAk3ge14juM0jbiLH5b9EhFC5JwHmy1C6Pj+Kn5a+X9ojPHqQl039T7PGWPd6dQ0dVVVTV1f4nVdFEVZlpznwyO7NaiNx+PRaASWehhuIYQAgPbYJXHs+/5K18FSXxnG82LxvPizMuDp/Mk2LY7RZhNyzpMkZYwJIfb7PElSFMdvwZjSrCqrIAgQQlVVUUqTJMGECik1CI35fA7AEgBgmqbn+WEQTKczAICu67PZzLJsx3Gm04mu677nua73vJj/eppwnv8F82VviluPhFAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.9\"\n        title=\"Figure 6.9\"\n        src=\"/CR4-DL/static/27ce2283356d84c7cff828e09165b761/d72ec/figure6-9.png\"\n        srcset=\"/CR4-DL/static/27ce2283356d84c7cff828e09165b761/63868/figure6-9.png 250w,\n/CR4-DL/static/27ce2283356d84c7cff828e09165b761/d72ec/figure6-9.png 393w\"\n        sizes=\"(max-width: 393px) 100vw, 393px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>The state of the RNN is reset between processing two different, independent sequences.</li>\n<li>However, the processing of those sequences is no longer a single step as the network internally loops over it.</li>\n<li>An RNN is a <code class=\"language-text\">for</code> loop that reuses quantities computed during the previous iteration of the loop.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/60adcb44f691718d8f892f004898fe1d/8cdda/figure6-10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFklEQVQoz3WQW3LDIAxFs/9tNkkbYxOQMHpid4Ak/er5YoQOuuIiIjxYHkvOWVVrrUQkIimlEIKqElGtVbVXlmVh5mldzvM8jsNbQ4CcMyKOPm2tqWqMERFLKSLSWmPm5/NZBkTUZVWdj82xZtbH5nS/3+GdZaZTVX0nPc+zywBgZudABs8Ya6332+3reh3ynlIqpcye1pqIdPk4DkR095esupc9hMDM27o9vn9EJKcUlvCR3f1vsruLKgIQETMfA2YGAERU1Zlr5keAuWCXdWBmiEhEZjb3nwcENLOxaa8QEeKroqoXd7dBCGvB8rlorWWAGKO7T7lXcg5hnQ+Z2WXbtv4Z+44FY4zruubcHQBIKc14//ELmlYJ0GsZkXcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.10\"\n        title=\"Figure 6.10\"\n        src=\"/CR4-DL/static/60adcb44f691718d8f892f004898fe1d/00d43/figure6-10.png\"\n        srcset=\"/CR4-DL/static/60adcb44f691718d8f892f004898fe1d/63868/figure6-10.png 250w,\n/CR4-DL/static/60adcb44f691718d8f892f004898fe1d/0b533/figure6-10.png 500w,\n/CR4-DL/static/60adcb44f691718d8f892f004898fe1d/00d43/figure6-10.png 1000w,\n/CR4-DL/static/60adcb44f691718d8f892f004898fe1d/8cdda/figure6-10.png 1168w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Usually, you don’t need the full sequence of outputs from an RNN because the last step already has the information about the entire sequence.</li>\n<li>The <code class=\"language-text\">SimpleRNN</code> in Keras takes inputs of shape <code class=\"language-text\">(batch_size, timesteps, input_features)</code>.</li>\n<li>Use the <code class=\"language-text\">return_sequences</code> argument to specify whether you want the full sequences of successive outputs for each timestamp or if you only want the last output.</li>\n<li>Sample of stacking RNNs</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model <span class=\"token operator\">=</span> Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>Embedding<span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>SimpleRNN<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> return_sequences<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>SimpleRNN<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> return_sequences<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>SimpleRNN<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> return_sequences<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>SimpleRNN<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>In practice, you’ll never use <code class=\"language-text\">SimpleRNN</code> because it’s too simple. Use either <code class=\"language-text\">LSTM</code> or <code class=\"language-text\">GRU</code>.</li>\n<li>SimpleRNN doesn’t work as well due to the vanishing gradient problem.</li>\n<li><em>Vanishing gradient problem</em>: if the network as too many layers, it becomes untrainable.</li>\n<li><em>Long Short-Term Memory (LSTM)</em>: an extension of RNNs with a carry track to carry information forwards in time.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/760585de0fe010ce8482459768181721/5c744/figure6-14.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVQoz02R25KkIBBE/f9fnH1pbTtEoKQU6gIiG8rs7JzHisysjMhBRHLO0zR550opIsIipRTn3DzPpRRVTSmVUqy10zTJQ0pJVQfvvajuiDFGZk4phRBUlYnCtjEzEdl1JSImQkRVtdaOrzHGODBzrTXGuO97fCCi1tp5FsTQLyxynqeqIiI9qGprbQAAIhKR+9vDBuCse7/fiJhzvrts2waQc5Z/tIfBOddjWmullBjjatYU4+s1fn39YWYMwTsXQmitXdfVK3ybe4frQUTicYAHETHLMr5GIgIA73yMsWv6/29zTzqOo5f/SQEARCwPrbWcMxEdx6GqOef/5lvN92DXdXV1r0dEvy99yNZafbiu6zbnUryHlNJ5nj/Sfd9DwJ6Sc6614r6vq2Vmfai1DqsxiLgYM88zwGZXa4xZlsV7vyyLMebz+QCAtdYD1FrbL/4C75I/8OtIVBsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.14\"\n        title=\"Figure 6.14\"\n        src=\"/CR4-DL/static/760585de0fe010ce8482459768181721/00d43/figure6-14.png\"\n        srcset=\"/CR4-DL/static/760585de0fe010ce8482459768181721/63868/figure6-14.png 250w,\n/CR4-DL/static/760585de0fe010ce8482459768181721/0b533/figure6-14.png 500w,\n/CR4-DL/static/760585de0fe010ce8482459768181721/00d43/figure6-14.png 1000w,\n/CR4-DL/static/760585de0fe010ce8482459768181721/5c744/figure6-14.png 1206w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>An LSTM saves information for later thus preventing older signals from gradually vanishing.</li>\n<li>Psuedocode for an LSTM</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">output_t <span class=\"token operator\">=</span> activation<span class=\"token punctuation\">(</span>dot<span class=\"token punctuation\">(</span>state_t<span class=\"token punctuation\">,</span> Uo<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    dot<span class=\"token punctuation\">(</span>input_t<span class=\"token punctuation\">,</span> Wo<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> dot<span class=\"token punctuation\">(</span>C_t<span class=\"token punctuation\">,</span> Vo<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> bo<span class=\"token punctuation\">)</span>\n\ni_t <span class=\"token operator\">=</span> activation<span class=\"token punctuation\">(</span>dot<span class=\"token punctuation\">(</span>state_t<span class=\"token punctuation\">,</span> Ui<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> dot<span class=\"token punctuation\">(</span>input_t<span class=\"token punctuation\">,</span> Wi<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> bi<span class=\"token punctuation\">)</span>\nf_t <span class=\"token operator\">=</span> activation<span class=\"token punctuation\">(</span>dot<span class=\"token punctuation\">(</span>state_t<span class=\"token punctuation\">,</span> Uf<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> dot<span class=\"token punctuation\">(</span>input_t<span class=\"token punctuation\">,</span> Wf<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> bf<span class=\"token punctuation\">)</span>\nk_t <span class=\"token operator\">=</span> activation<span class=\"token punctuation\">(</span>dot<span class=\"token punctuation\">(</span>state_t<span class=\"token punctuation\">,</span> Uk<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> dot<span class=\"token punctuation\">(</span>input_t<span class=\"token punctuation\">,</span> Wk<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> bk<span class=\"token punctuation\">)</span>\n\nc_t<span class=\"token operator\">+</span><span class=\"token number\">1</span> <span class=\"token operator\">=</span> i_t <span class=\"token operator\">*</span> k_t <span class=\"token operator\">+</span> c_t <span class=\"token operator\">*</span> f_t</code></pre></div>\n<ul>\n<li>Three advance RNN techniques\n<ul>\n<li><em>Recurrent dropout</em>: uses a temporally constant dropout pattern.</li>\n<li><em>Stacking recurrent layers</em>: recurrent layers that are stacked on one another.</li>\n<li><em>Bidirectional recurrent layers</em>: recurrent layers that learn using both the forward and reverse order of the dataset.</li>\n</ul>\n</li>\n<li>The common-sense, non-ML baseline is either to guess randomly or to guess the class that appears most often.</li>\n<li>E.g. If the data contains 90% of class A and 10% of class B, then the baseline is 90% because if we always guess A, then we will be right 90% of the time.</li>\n<li>If you don’t have a baseline to beat, you can’t tell whether you’re making real progress.</li>\n<li><em>Gated recurrent unit (GRU)</em>: a streamlined version of the LSTM.</li>\n<li>ML is about the tradeoff between computational expensiveness and representational power.</li>\n<li>The proper way to apply dropout to RNNs is to apply the same pattern of dropped units at every timestep instead of applying a different pattern at every timestep.</li>\n<li>Vary the dropout pattern between sequences, not within sequences.</li>\n<li>To stack recurrent layers on top of each other, all intermediate layers should return their full sequence of outputs instead of just the last output.</li>\n<li>A bidirectional RNN processes input sequences chronologically and anti-chronologically. It trains in both forward and reverse time.</li>\n<li>Interestingly, reverse-order processing on text works just as well as forward-order processing in some cases.</li>\n<li>Although the word order does matter in understanding language, which order is used doesn’t matter.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 931px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/e211684eaf9ab1d21948e022833465e2/82b28/figure6-25.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVQoz42Q226CQBRF+f9/amxfq7VyiU0RQajMzBkQcApzZZimmlbTxNT1uJO198nx3BXGmLJECCFjjLsD79qs68P+Yw8EDofmHv8ic87DIJo9PM5mT0EYCS6cc9M03btcVdV2u43jDaV0HMf/l4d+6NqOAiWYMMbOKWOfGGMA6NqOc35TJgTSNJs/L5IkJQS+75wmgkmySRbzlzTNqqq+KVtrlVKMsfHEObXWaq3Z8ai1ttbelJVShBBKaVkipdQ5lVJihAgApVSIv5+bfvCEFMMw1HWNMZZSaq3VCYxx2zR931trOedaa865MUYp9VvkARA/CN/jWAiJECqKYrfbAdC2aQI/yLLcOecH/mrlR2H0tl4vl695nlOgeV58AbfrPi7YNv0BAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.25\"\n        title=\"Figure 6.25\"\n        src=\"/CR4-DL/static/e211684eaf9ab1d21948e022833465e2/82b28/figure6-25.png\"\n        srcset=\"/CR4-DL/static/e211684eaf9ab1d21948e022833465e2/63868/figure6-25.png 250w,\n/CR4-DL/static/e211684eaf9ab1d21948e022833465e2/0b533/figure6-25.png 500w,\n/CR4-DL/static/e211684eaf9ab1d21948e022833465e2/82b28/figure6-25.png 931w\"\n        sizes=\"(max-width: 931px) 100vw, 931px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>When it comes to markets, past performance is not a good predictor of future returns; looking in the rear-view mirror is a bad way to drive.</li>\n<li><em>1D convolution</em>: a convolution in one dimension where the window is the slice of time.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/88e5dab8ef971adc74e7ad88e9987a51/8de58/figure6-26.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABL0lEQVQoz5WQYWuDMBBA/f//aWOFsa4MOmj7wbRqEapiNJpoctFcTEYrhTKKY+/jcQ/eXeCc894LztM0tdb6/xB47xGRMZZluRBCa63uAAAiLsmgNed8u/1erd7DkAghaFlSSquqomXJGOOcz3VPZDtNfd/vdvuP9eZ0ijjnV3OWKe1Ex2pmjFnKFlwURdH3/TAMoGFG36K01ks3e+/j5Py5+cqyTCk1jqNzbpom59x44w95tz+8vL7FUdw27fKTnshCiDiO8zyXUj4+x91YkufCtmloWRZFYYyxD8wLBq/cZ5O1FhGDQWspZdd1SXJGRGPMfKcxBgDquq6qCgDIkSRJkqYpOR7DkBwOe0ppoKQEgHEcL5fsVxUi1nXdtq2SkhAShiEh5BRFjLGmYUqpH3pYeW4gWhu/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.26\"\n        title=\"Figure 6.26\"\n        src=\"/CR4-DL/static/88e5dab8ef971adc74e7ad88e9987a51/00d43/figure6-26.png\"\n        srcset=\"/CR4-DL/static/88e5dab8ef971adc74e7ad88e9987a51/63868/figure6-26.png 250w,\n/CR4-DL/static/88e5dab8ef971adc74e7ad88e9987a51/0b533/figure6-26.png 500w,\n/CR4-DL/static/88e5dab8ef971adc74e7ad88e9987a51/00d43/figure6-26.png 1000w,\n/CR4-DL/static/88e5dab8ef971adc74e7ad88e9987a51/8de58/figure6-26.png 1219w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Like 2D convnets, 1D convnets find local patterns in the sequence so one pattern learned at one time can later be recognized at a different time.</li>\n<li>This makes 1D convnets translation invariant for temporal translations.</li>\n<li>E.g. If it sees that after it’s cloudy it rains, then the next time it’s cloudy, it’ll predict that it’ll rain.</li>\n<li>Just like max pooling, 1D sequences used 1D pooling.</li>\n<li>1D convnets can’t learn longer-term patterns as well as an RNN can due to only focusing on local patterns.</li>\n<li>However, for very long sequences, you can use a 1D convnet to reduce the sequence’s length and feed that into an RNN.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 562px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/57feaaa11c23ef4457573670902fccc9/6e88f/figure6-30.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 116.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACTElEQVQ4y4VUiW6jMBDl/79tV1WVJuEMZykFAp7xbcCswG3UTZX2CQk8h9/M8xhvfQClVFVW67paax/FeHdrYwznnFIKAF3XMcYopYKLeZp/SRZCAIDW+nsVAKCUepg8zzMA3Op8b5rD8wERnddaCwB3LfzHTCnlnLuIeZ6VUtM0reu6LAvbXT+Vba0VQiAiRWSM8R3bklIp5XflvEdKCiHS5HK3tcu3n/C++tZ1JSPpu46MY1mWZVG2bUvGcRiGpmlc/1/575kRYJqmZVnSDVldv7n+u7bNsyyJkrIo8iwvirLr+nvma98j4i7183mD3/dXzlhZFO9NI4XknAMARRSce9+PlHOutQZC0jQ1xkgphRBSSqf8L4IZrY0xlNLXqtI7psn8ItieZsZxdDzLsrgTlnIrlRBijHnIvCyLmzCnUF3Vr1VV5MWyWOdFxIcTZq1FxNtIUUoZY8N1cAlaa0rpTz3P8+zmSUlljNm7naSUzuga+Wk8Ha1WihASx7HWRgp50+k+ebheyQ3jSMYNQMg4DM3bGwDc7NvzCXfDvL7vHZu11hWGAIHvJ5c0iqI4SaIwBMBbjOMfh2GaJg/3zWHfDBGBENxemxGB4G6kFD9iNuPmY4xtZTPGlJRaayUlUryNFOdcCKF2AKD7kJ9wfxvvcrk8PT2dzn6SJH7gI9L6tfJ9/3B4OZ5Ox5eXqix8P0izLAyjIAjyPDudz23bbcl1XSeX5O/fP0EYZFmeZ9neaRLF8fl0ytLUD4Kyqs7HYxgGURwnl0Trj1H7B2jcLdlWfPdHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 6.30\"\n        title=\"Figure 6.30\"\n        src=\"/CR4-DL/static/57feaaa11c23ef4457573670902fccc9/6e88f/figure6-30.png\"\n        srcset=\"/CR4-DL/static/57feaaa11c23ef4457573670902fccc9/63868/figure6-30.png 250w,\n/CR4-DL/static/57feaaa11c23ef4457573670902fccc9/0b533/figure6-30.png 500w,\n/CR4-DL/static/57feaaa11c23ef4457573670902fccc9/6e88f/figure6-30.png 562w\"\n        sizes=\"(max-width: 562px) 100vw, 562px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>Summary</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 852px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/4c72702a8ec18dcba22ec869efb23e9b/47ff6/chapter6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACx0lEQVQ4y2WT2a6kOAyGz/s/XKur2MKWzc4GVBWQQNXR3IwcTl9Mj2Qhsxj//n7n6/kELuuBV0I2rLtraNenWma+TPy1yDmMy8Qfi1jC+FzEY6ZYnyr4Pu3m6/s9vZM1ugZVOWTBdqBqA41BZpBZZKhrk6/OtAYY6uaxiPWhjmi/zuTO5JxptaSPlCi1rB6zOKJZnzpuGDezvSBt5kwu7TbtlHzO8D781/vw78PP0yh4YbEFWUl+58PNAgNdy/FusZW81LJ8H/77PV3x3+IwgKoRGiVKJUoDDaoaNV0vtVIUUxic6bztJz9MfkjRUvHnDMs06ixYy4oailLyAlUdN1yf+vVQ+4pZtjl2GzfcVziTy52pmCM03ly0GMgKgWlVi/GmVaVkaYBdqJeZxw3/+Z6z7DOkTYcsZg6DkpXFdgqDgcaZ1pmWfmq74HolS9DZCGjmMBLtz+nTbpQoQdXOdoIXkhfUXJF5NvP3rkPIXtpu9oNFZoCRz58zpB1R16jr4IYMowdZWdNaZEsYnWm9653pLLLXQx6R3LoM+3ofIW0ghrsWuQ8vBC9Q10oUkpdKEjlBhjE+3FDVfLh17S8pin1FAnbshlzRDag6OGL2mAUhpQ0hsFer+HOL1+ZQ588Z4qoNMANNcDSPt12GlwVbMpbI2e4awSIL+W3as89HcnmHKlCkFrI3Y//bmpZ2RlZ8uPHhLnmhJXHl433sf69PnTtv6EwbN3tE2vO4mT9U7BndEe2R3PWE8hw/wC7ZoCqDjaVNbCbXGySrLDJrKNGyCq6nibJ+a5jF9gdY2i0Co2VWNRC2SvKSj3cDlPPxElyhbrQoUdfXgNsLrmLjbQuKzkPefhZc723r7RBcH/ywr3BEe5J4d14jREvr+XpIUJ1BichBC605gpBSLgu881G/Tu91Bv+KTDu6I/mcUJzJJ+rg///1X8X/Al6lNZyIl2NWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chapter 6\"\n        title=\"Chapter 6\"\n        src=\"/CR4-DL/static/4c72702a8ec18dcba22ec869efb23e9b/47ff6/chapter6.png\"\n        srcset=\"/CR4-DL/static/4c72702a8ec18dcba22ec869efb23e9b/63868/chapter6.png 250w,\n/CR4-DL/static/4c72702a8ec18dcba22ec869efb23e9b/0b533/chapter6.png 500w,\n/CR4-DL/static/4c72702a8ec18dcba22ec869efb23e9b/47ff6/chapter6.png 852w\"\n        sizes=\"(max-width: 852px) 100vw, 852px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"chapter-7-advanced-deep-learning-best-practices\" style=\"position:relative;\"><a href=\"#chapter-7-advanced-deep-learning-best-practices\" aria-label=\"chapter 7 advanced deep learning best practices permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 7: Advanced deep-learning best practices</h2>\n<ul>\n<li>Sequential models are limited in that they have exactly one input and exactly one output.</li>\n<li>However, you may want a model that\n<ul>\n<li>takes in multiple inputs</li>\n<li>returns multiple outputs</li>\n<li>has a graph-like structure</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/1c944bd9487034563818358db8a82a68/d72ec/figure7-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 146.00000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAIAAAAl5NuSAAAACXBIWXMAAAsTAAALEwEAmpwYAAADLklEQVQ4y5VUiXKjOBT0/3/TJluTmXhntyoGY7C5kRBgdHBJGIIxsAU4jmNnM7Ndr6CqoXlS03qL4TNEYbjeqJqqbTZakRfDMPR9f//aYn5wg7qqKGUQQkLosWnu33kXf4rqcJAl6b96nsV1XYdhyCYkb0iTJI5jfbtL0/SaZ4wRQvZRdBbzoiAYd11XXIFzzhhzHEcInuf5TOZ5LoRo2xYhNC9nId5gGiaEEEzwPA9CHwA4Xd9h23bbtpSQs5hzLoTIsszzAKUsjjGlDHjgx9Pzwx+Pz8ufmFCMCcaEEAoALIWghHRd90FsmlYYRggFCAUAQEM3LMuxHXdmEAqCIDRNq65rchELIfI8H4aBXSFN0/0+fnl5KYqCUjqTlNIsy4ZhwHH8vueZOl7hdDrxopAlqeu6pmmu+WEY4ncx5/PK9Z3uup7juFM5AEDfRwCAN2Ys0zDb45Fg/AvDlj+Wjw9/Ln/fsCjaz8ZA6O92umlatu0GQThXGEamaVVVdWtY3/eE0EsxlsT7/Wq1yrJs7kmm/mmSfm7Y6Qp93wvO52y3bXvh54a3hpWi1HXjYphtOwAA30ee99Ew02rb9s6w9N6w54eHx+XzXxh/aRjnPE3TOWG+j1AQAg9oqrbd6oZp3STscDgQQvqu/5AwOroyfp8QkkxHUpblLMvHjhMIIWk6GXZZdlmWyPfLUgjB5/1zzvMsDYPg6du3oigSxtLphM9FCfE873yej00jS7Kmajtd3253siSrG7V6bcqyDMPw2DR1Xb9eYU7rWdx1HcYYjllEcYyjMIrCcBiG7nTinA9f4n6GjZt5fa12ui4rG9cDX82wm7HYdd18L0VJKTscqv/R+Ys+n4g9zyOE8GnoFXlBCBZCTFEnWZYxxg4TxiyVYgqU4Lx4nYb5wnGd70/f//n751rZJEkaIOT7/jAMlmVBCFVVkaTVWlkrynqzUV3XtW3LMM2qGrezIBgjFDiObZhWWZaMUt0w/dF7xNKUTH/VcRw8RchxHAj9ACEIYJbnC8swt9udoqwlWUmSBADPsmxN01arlT9OQqAoiiRJY2aB5/v+er3eKIqqaTHG/wLaJVDXKUJd8gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 7.1\"\n        title=\"Figure 7.1\"\n        src=\"/CR4-DL/static/1c944bd9487034563818358db8a82a68/d72ec/figure7-1.png\"\n        srcset=\"/CR4-DL/static/1c944bd9487034563818358db8a82a68/63868/figure7-1.png 250w,\n/CR4-DL/static/1c944bd9487034563818358db8a82a68/d72ec/figure7-1.png 393w\"\n        sizes=\"(max-width: 393px) 100vw, 393px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/0dff8e5fd247f3f99d0fa0f13b1b374f/97bfd/figure7-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQY042QTQ6DIBCFvf+xWnsGoQsjiBgDTEDRFOWnUZLGVfXbzFu8mTczRTrhPs4YI5V0zqUbFD8VY9RaM9a1lGltQgi3mrMvhMBaVpav56NkrNu2LU+MMV4ne+/neZZCDMOwLIv3PqV4kUwIQQhXFcIY13WN9vpumqaq0K4RJoSc8+OJAgD6vqeUCiEAgHNOKQUAIUTHeEtbpdS/tadpgsOxrqsxBgDyt8dxtNZmg1Rqsna/60BrDUp9Ada3kxNnk0uxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 7.2\"\n        title=\"Figure 7.2\"\n        src=\"/CR4-DL/static/0dff8e5fd247f3f99d0fa0f13b1b374f/00d43/figure7-2.png\"\n        srcset=\"/CR4-DL/static/0dff8e5fd247f3f99d0fa0f13b1b374f/63868/figure7-2.png 250w,\n/CR4-DL/static/0dff8e5fd247f3f99d0fa0f13b1b374f/0b533/figure7-2.png 500w,\n/CR4-DL/static/0dff8e5fd247f3f99d0fa0f13b1b374f/00d43/figure7-2.png 1000w,\n/CR4-DL/static/0dff8e5fd247f3f99d0fa0f13b1b374f/97bfd/figure7-2.png 1078w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 614px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/fb849212ee2d839b1a5f1d5e86835245/e9131/figure7-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzUlEQVQoz42S6Y7aMBSF8/5vVQqBgArNQDJkKmLHW+xg0DQhm5ekYhFCkBn1/LvLd23dcx1rbd/3meBhuJXy0Pd913X9g65hStn2PVJKPTY494AQbLTpv5BSKmXp02jneDwKIbIso5RKKYUQh8PhXtZaZ2ftOeeEECkl57woihuMEOZcvPn+6MfP9XrDGIMA3l8oyxLCJE25v/InYxchjDHhnF8bHEIIY2w280ajsefNMaYoQefaZfbpdMKYfHz8cSfT8XiyWvkYE8HFDZbywDnPsiyO4/V6zSjb7/eP3xZCIISWyyWlVAiRpmme5zf4ca9aqaauq6pqmqbrOmtt0zRVWTZNY8zALp0nS/I8x4RghEEMIIAYYyGE1vrVvAGYsXQ+Xyx/Ld2p57ozz1vMvUVd16/+D8CcC8bSMHx33el05sUAxjEoy/K/4KI4cc6llAAAhNDF+ezp2wPw05RTUVyP4fXB72CtdZIgSs/XIvfyG94ZzNYXw6qqatu2/1qOUq0xRmujtLbWmrO0NcZae7XaXFNat22rbzJKKa21AwH47b/BJMEEf37+zYTY7XZBEO7ieLPZRNsIY5wkSRRtwyCIomgbRRAmQRgAAP4BulSOgfXqYn4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 7.3\"\n        title=\"Figure 7.3\"\n        src=\"/CR4-DL/static/fb849212ee2d839b1a5f1d5e86835245/e9131/figure7-3.png\"\n        srcset=\"/CR4-DL/static/fb849212ee2d839b1a5f1d5e86835245/63868/figure7-3.png 250w,\n/CR4-DL/static/fb849212ee2d839b1a5f1d5e86835245/0b533/figure7-3.png 500w,\n/CR4-DL/static/fb849212ee2d839b1a5f1d5e86835245/e9131/figure7-3.png 614w\"\n        sizes=\"(max-width: 614px) 100vw, 614px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 859px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/c5a4c9dd6cdf7101fb492c648221a451/39a20/figure7-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPklEQVQoz42Q3XKDIBBGff+3axpFBSe6oIARAUch+EenzXVbz/V+c85s8njUACxNs9vtDkAfj9o5F2M8zzP+RyJlr5SiQOu6UWqUsg8hxGsk53nEGMdxFELs+75t23EcV7Tv8fcd7zjGeFnmdV2ttd77K+WJc857r5R69s81rC//enPJXNdN23YoQ/fPO2Nt04C1kxoGoFQI8bc70dpYazjnjDJrrTHGez8MA6MMAN79v47btpOyJ5gUeSllz7mYpmld10vZff9UamwaIKSS8imE1FqHEM7jMFrP8+ycCyHM82yMWX6YpklrvW17MgxqHDUAzVHO2o5SprXef0AIYYx5x3spq6rCJSaEFEVBSGWtPc7z+2FdJ/K8yLJcCAlAl2WJMYbXCyH08XFLs6wsy6IoUZblCKVphjFGCAHAFyr/cjHoDJumAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 7.5\"\n        title=\"Figure 7.5\"\n        src=\"/CR4-DL/static/c5a4c9dd6cdf7101fb492c648221a451/39a20/figure7-5.png\"\n        srcset=\"/CR4-DL/static/c5a4c9dd6cdf7101fb492c648221a451/63868/figure7-5.png 250w,\n/CR4-DL/static/c5a4c9dd6cdf7101fb492c648221a451/0b533/figure7-5.png 500w,\n/CR4-DL/static/c5a4c9dd6cdf7101fb492c648221a451/39a20/figure7-5.png 859w\"\n        sizes=\"(max-width: 859px) 100vw, 859px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>The Keras functional API lets you use layers as functions.</li>\n<li>E.g. The <code class=\"language-text\">Sequential</code> model converted into the functional API.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Sequential<span class=\"token punctuation\">,</span> Model\n<span class=\"token keyword\">from</span> keras <span class=\"token keyword\">import</span> layers\n<span class=\"token keyword\">from</span> keras <span class=\"token keyword\">import</span> Input\n\nseq_model <span class=\"token operator\">=</span> Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nseq_model<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nseq_model<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nseq_model<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ninput_tensor <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>input_tensor<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\noutput_tensor <span class=\"token operator\">=</span> layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nmodel <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>input_tensor<span class=\"token punctuation\">,</span> output_tensor<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>The compiling, training, and evaluating is the same for the functional API.</li>\n<li>Multi-output models require different loss functions for the different outputs.</li>\n<li>However, SGD requires a scalar to work.</li>\n<li><em>Residual connection</em>: a connection from shallow layers to deeper layers that allows re-injecting previous representations into the deeper layers.</li>\n<li>Resnets are built using residual connections and tackle the following problems\n<ul>\n<li>vanishing gradients</li>\n<li>representational bottlenecks</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/e244cacc35b8e806a21e68711850c39d/844cc/vanishing-gradients.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvklEQVQozz2RW2/qMBCE8/9/Vk8plwCxHcd2fI/vSSFA1UL7VoVKR5qH0Wqk/Xa2Op+d8cInFbM2TuRiQ9KpGON5KubnMX3fx5/H9F/f9/Fv8vgqVU6io8e222Ny4KJVGkuJOIesB1LhHHlJPMd+UeLR0xz7sYgY2PXiKj904PCvOb6QdkPwjtEaNK/N4YWRGoEVguun3jDaHPcvfwY2K9iscuyrMQsloVFISRADsxppCZUEWsDg6VhkcCSFfioyevo+qhiYG7qpyOs8VOdJ59CnwHLsyxPM2c47kmM/n+x1dreLu87uenG3i7/N7nIePq7hdvGfH7EqmUveiP5oFBoMtro1ChmNrEYEbyVvenbQCinRKAFJt6NkryTg/eE06co7guAbgusWrVu4JnhL8JbRumu3CLy1aAPBitE9wbvlYLyh3Y6RGhxfc+LVVKSSYLDYKGR162wnBTCqdQZ72y0gGjqLtYR+INYsASWAEuD8rqsUGMFbJf+Qakb3jNQEb/unYXTf4R3tat4fJG8oqSVv9HPNgj2fbHBkzCI4GjyNnkVPS+JpaXF5b4pLnSXxMYvo2Xyyj69y/8z3z/wLehAE+w8yIxwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vanishing gradients in deep learning\"\n        title=\"Vanishing gradients in deep learning\"\n        src=\"/CR4-DL/static/e244cacc35b8e806a21e68711850c39d/00d43/vanishing-gradients.png\"\n        srcset=\"/CR4-DL/static/e244cacc35b8e806a21e68711850c39d/63868/vanishing-gradients.png 250w,\n/CR4-DL/static/e244cacc35b8e806a21e68711850c39d/0b533/vanishing-gradients.png 500w,\n/CR4-DL/static/e244cacc35b8e806a21e68711850c39d/00d43/vanishing-gradients.png 1000w,\n/CR4-DL/static/e244cacc35b8e806a21e68711850c39d/844cc/vanishing-gradients.png 1306w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>You can use models as you use layers. Think of models as a “bigger layer”.</li>\n<li>E.g. You can use a model to evaluate a single input: <code class=\"language-text\">y = model(x)</code>.</li>\n<li>When training a model, we currently let the model run until it starts overfitting. However, this is wasteful and inefficient.</li>\n<li>A better way is to stop training when the validation loss stops improving. Use a Keras callback to implement this.</li>\n<li>Examples of ways to use callbacks during training\n<ul>\n<li>Model check-points by saving the current weights</li>\n<li>Early stopping when validation loss doesn’t improve</li>\n<li>Dynamically adjusting the value of certain parameters</li>\n<li>Logging training/validation metrics</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/d4b0e0442cbc104ae32dc13b1d4f46e1/abe2a/figure7-9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQY043QwU6EMBAGYN5bfZM164VnWA/wChw5uFCEWtpdllDssJOWMjWC3iTxu8xl/syfiYgohOC9R0QhBADM80y/llXYEW3DWouInHNjjHMu/E/0dj4L0Vprx1E75xBRSVmWJecfTcMPh+fT6TWE8Of9qCy+9xARAJIkiePYWltV71qPQoiHx6fj8WU3DADDMEzTvaqqOI7TNCWitpUAME2glNJa79YuikJKaYyRUmqtzaqua8YYIi7LQkTe+2X5ed7Ge09EUZ7njLF5nj/HsbvdhmEgIsZYlmVb277vhWjHlVKq664XdWk4n6b7F34ai15NOuv+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 7.9\"\n        title=\"Figure 7.9\"\n        src=\"/CR4-DL/static/d4b0e0442cbc104ae32dc13b1d4f46e1/00d43/figure7-9.png\"\n        srcset=\"/CR4-DL/static/d4b0e0442cbc104ae32dc13b1d4f46e1/63868/figure7-9.png 250w,\n/CR4-DL/static/d4b0e0442cbc104ae32dc13b1d4f46e1/0b533/figure7-9.png 500w,\n/CR4-DL/static/d4b0e0442cbc104ae32dc13b1d4f46e1/00d43/figure7-9.png 1000w,\n/CR4-DL/static/d4b0e0442cbc104ae32dc13b1d4f46e1/abe2a/figure7-9.png 1067w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Use Tensorboard to visualize\n<ul>\n<li>Metrics during training</li>\n<li>Model architecture</li>\n<li>Histograms of activations and gradients</li>\n<li>Embeddings in 3D</li>\n</ul>\n</li>\n<li>Advance neural network design patterns\n<ul>\n<li>Residual connections</li>\n<li>Normalization</li>\n<li>Depthwise separable convolution</li>\n</ul>\n</li>\n<li>Normalization makes different samples seem more similar.</li>\n<li><code class=\"language-text\">BatchNormalization</code> is a type of layer that can continuously normalize data throughout the network.</li>\n<li><em>Depthwise seperable convolution</em>: separating the learning of spatial features and the learning of channel-wise features.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/e81146dc81ae4bc12b56e41c3a02fb5c/78415/figure7-16.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVQoz42Q246CMBRF/f+/8lUSFUEwXAzlVqAXQJG29MIEGZlMMg+znpp9zmpO9m7+oLXuuu71eiml5v+x215pmnqe7zhunhf/lfUHhFAcxQAAQugWGmPWPfObb1kIwd8QQrIshxBSSvmHcRy31b/PXsd13RyPJ+tgYYy3Med8rYBgHIVRWZSwhPf4PgzDInddhxqEGlSvVFVd180S4bZtH4+HlHKe5yzL9vv9+XS2DpbveUrrRQ7DyHFckICbfwMJSEHm+7ckAVfHDcMINUi9Zc45pfT5fGKMhRA/ZyulpJSEkCIv8ixr21ZKqd9/T9PExYKcJqWkEEJrvYSMLbIxRmlljAEgPZ9t274URWmMWdsWQjSocV03ju8AANu+BGEYBIF7vXZ9v1tbZYwJIfq+H8dx658xNk3TMAwQQoQQoRRWFcGYEAJhxTn7AuToOLJssebwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 7.16\"\n        title=\"Figure 7.16\"\n        src=\"/CR4-DL/static/e81146dc81ae4bc12b56e41c3a02fb5c/00d43/figure7-16.png\"\n        srcset=\"/CR4-DL/static/e81146dc81ae4bc12b56e41c3a02fb5c/63868/figure7-16.png 250w,\n/CR4-DL/static/e81146dc81ae4bc12b56e41c3a02fb5c/0b533/figure7-16.png 500w,\n/CR4-DL/static/e81146dc81ae4bc12b56e41c3a02fb5c/00d43/figure7-16.png 1000w,\n/CR4-DL/static/e81146dc81ae4bc12b56e41c3a02fb5c/78415/figure7-16.png 1207w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><em>Hyperparameters</em>: the architecture-level parameters.</li>\n<li>E.g. How many layers/neurons to use, how many epochs, use dropout.</li>\n<li><em>Model ensembling</em>: pooling together predictions of a set of different models to produce better predictions.</li>\n<li>E.g. The group of blind men exploring an elephant story.</li>\n<li>Ensembling assumes that different models are good for different reasons hence combining them makes them more effective. The models must be different and diverse.</li>\n<li>The whole is greater than the sum of its parts.</li>\n<li>You want ensemble models that are as good as possible but that are also as different as possible.</li>\n</ul>\n<p><strong>Summary</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/032f85d8f2993362349f592f6915a7e9/20785/chapter7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVQoz22R25LiMAxE+f+f24KEOCS+ynZ8k20yDAHmactk2KetUumtu09Lh5y1ttwFmRCsEwnh9Yj7PLff/bj7/84hZz2zfqI9l4RMJ6Uva4WCsqAoWeYk1qo/duH1iD/Pj/XdH15b+Hl4DNRq4sxo9aBhUKL3y8Tp0QDh7Bg9DW7GyGOg0dMUmV+m22oPj7t/bqFmpURvNZG8s5poNSxm1GowauD0COosRQfyLNhJio7RI6fHtcCvGBPXMFgzCn4CddZAWqwmfpnWquubv6B479YII/+6msNevWa1mHG3NzA4e0mBBTenwJogy4ISIy8oo6OYeC1qvep/2NKoAWQvRa/VWfAuo6zYAvfYjKJm9Ulu4b/Jzy3kJJToDRANA6izd/NaIKeGV7NKgRWUNSuMrGR5LSonfls/2AWlX+boqTVj8HRn3jlTYDHQt5FIgaXIMfLFXr6aeAu3VVlNQLW2Vo8GCKj2LcFOVhM6/ZG8W8wIshe8A9kr2RsY1vq+9vbtsBmzFFkKDANzyxzc7OyloPCuEWEU0b+fHFj09FrguYW/YRBRWN30wkYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chapter 7\"\n        title=\"Chapter 7\"\n        src=\"/CR4-DL/static/032f85d8f2993362349f592f6915a7e9/00d43/chapter7.png\"\n        srcset=\"/CR4-DL/static/032f85d8f2993362349f592f6915a7e9/63868/chapter7.png 250w,\n/CR4-DL/static/032f85d8f2993362349f592f6915a7e9/0b533/chapter7.png 500w,\n/CR4-DL/static/032f85d8f2993362349f592f6915a7e9/00d43/chapter7.png 1000w,\n/CR4-DL/static/032f85d8f2993362349f592f6915a7e9/20785/chapter7.png 1307w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"chapter-8-generative-deep-learning\" style=\"position:relative;\"><a href=\"#chapter-8-generative-deep-learning\" aria-label=\"chapter 8 generative deep learning permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 8: Generative deep learning</h2>\n<ul>\n<li><em>Generative recurrent networks</em>: using an RNN to predict the next token(s) in a sequence using the previous tokens as input.</li>\n<li>E.g. Given “the sky is bl-” predict “ue”.</li>\n<li>Once the model is trained, sample from it by feeding the generated output as input.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/aa644608ed8a333ceec0da4e23e117e2/1d553/figure8-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABRklEQVQY002P3U7jMBCF8/6vAK+AVvAGC0uB6+WiTUWRoGnIeGwntuOf8R9KoZTvYjQ60pk5p6m1EpEQMoRQaw0U+r5Xk3LOIaKUo+AiBB9CiDGWUgCg6w4UY621McYgw1FKRNRaz8Zs2+3D6un9fb9t2z9XV1LKdtM+rB53u1fvlyullHqkISJrrXPOWktE3nshRN9/GD13++7m+ppzPo7joTtIuaQzxpzNp2UhRiIipdQ4jkqplNJRjGpS0zRpbeIx7Q8N55wxxhABABlqYzbr9u7239vb/vn/8+XFBWNsvd7c/r17edk557zz588553gi55xSmudZax1CEEKs7ldKKWOMkFJrTUTOubM5xphSKqWkEznnUspRXmL7Xzjnvv+kpWEzwAAA1lrOOQAIIRBxGIavCcOwKIzBoiwFkWG37xgwgOETjhrDb6qZ0PUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 8.1\"\n        title=\"Figure 8.1\"\n        src=\"/CR4-DL/static/aa644608ed8a333ceec0da4e23e117e2/00d43/figure8-1.png\"\n        srcset=\"/CR4-DL/static/aa644608ed8a333ceec0da4e23e117e2/63868/figure8-1.png 250w,\n/CR4-DL/static/aa644608ed8a333ceec0da4e23e117e2/0b533/figure8-1.png 500w,\n/CR4-DL/static/aa644608ed8a333ceec0da4e23e117e2/00d43/figure8-1.png 1000w,\n/CR4-DL/static/aa644608ed8a333ceec0da4e23e117e2/1d553/figure8-1.png 1159w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Example sampling strategies\n<ul>\n<li><em>Greedy sampling</em>: always choosing the most likely token.</li>\n<li><em>Stochastic sampling</em>: randomly choosing the next token based on the token’s probability.</li>\n</ul>\n</li>\n<li>Stochastic sampling is better than greedy sampling as it provides more variety in the generated output.</li>\n<li>However, we want to control the randomness or “creativity” of the network to tune how predictable or surprising the output is.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/2300b2305505fbc1207be918bfb799a0/6be49/figure8-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZElEQVQoz42RW2/bOBBG9f//0QIbIF20u72kdppsEsexFVmURFES7+LwJlKFnWJb7FPPGw9nMIP5CiVljLFBXd/3nDEpRAghp8S5aFA7TZMUAgBySs7ZgQw9xpxzJVUMocAdjsF+3dZSmbTEGKOzDmZZVtP+QNY1hbPxdJwsGOd/EGP0Foqu63KOt/cYIKwXzh/O1EiUFXszx1d2OLRLDLv9+GZCTBiLYhzGtITtXWfAr+uacw4hnJubn80vx+nl0MYQbrbdm9Fz+HRzKggha142d9j8Mjl6U534oaTLktZ1fX4ZXw6tUvB50/ZEK+0mZj98ei26plWS7/doHCYlpeCcjpNWAjW073nbThagqoaBTAiNT8+4RtPxSMpy2D23RQjBGAAza6VmbZRSWumc8/obFDnnGAPpSY97SinnPC5xWaLgom0aQghnTCudUgIA3OGmaSmlSinvfRGCBzOnfEnpzOK9U1IsKZ0fF9KyaCWdtTH+LLPWFpfbWu+X/1ZdYtRK/m/DWasYw68mhFAE72NwD7vBuniJan18wmZWlAEZ5rc6LmyPxyUGyu2PASlTqosYvODy+n2FEH89MSHgjz933s4fPp4ed+TfBywlXL0rj8eu78XVX+WpZsdyOpT06npfrGueRvFlUzct+7pFx3K8f+iCN9tvzfOe3GzQ4xPe3DaCSYSmfz5Xt3ft3x9fN7fo8aktGGVCiOAtY9SckxJCMEqZhVlrKSXXWijFKZ1mo8EoJYWZpXdmNrpACNV13bYdQk1do6o6nU41IaTrcF3XGBMAq7UBAOecAZhnYwxY5wDsd+0mS7cK+YFuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 8.2\"\n        title=\"Figure 8.2\"\n        src=\"/CR4-DL/static/2300b2305505fbc1207be918bfb799a0/00d43/figure8-2.png\"\n        srcset=\"/CR4-DL/static/2300b2305505fbc1207be918bfb799a0/63868/figure8-2.png 250w,\n/CR4-DL/static/2300b2305505fbc1207be918bfb799a0/0b533/figure8-2.png 500w,\n/CR4-DL/static/2300b2305505fbc1207be918bfb799a0/00d43/figure8-2.png 1000w,\n/CR4-DL/static/2300b2305505fbc1207be918bfb799a0/6be49/figure8-2.png 1160w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Skipping over the DeepDream content.</li>\n<li>Skipping over the neural style transfer content.</li>\n<li>The key idea for image generation is to develop a latent space that can be sampled from to generate images.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/fe42b8a2c6ae9dbd58a727a8625580e1/f43e4/figure8-9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmklEQVQoz5WQTWsUMRjH95uIX8Cbd7+FpxaPHvTUDyDYk6UH35CCL6gUEQtCPetpexKthe3uFHVLO8kkefIysySZzC7JJLIz7bHS/gkhPDw/fvwz+PLx/Ydnj9493dh5u1VKUdvaGBNjTJfI4NPrF1ub65/fPN959aRS0jlnrb0sLBj5nY3/ZOO/2cgak66SQUqpaRrGGADXWqeU/q+N5+nMQgADUpCyVN77q5kRwpQyQijGhXMupVTXdYyxqiqlpDqPlDLGJIE+frD28P7qz+G3JYxxoVS5N9w7+HVQVdVsNgMApdTpaZ5lR4eH42xyNBqNj49PtNb7P77funH99s1ru9svOxhhxqCTk97c3bEsKyGUlGdHCNHGKIGu3b2zfm9lf/h1CXPO8zxHCAGAcw4jjBESQl7U0xhDGT/rPJ/Pp9NpNplYa3uttXaxWFwEe+/nTZP633bOaa2N0XVdhxDato0xhtCG4EMI3vu2bUMX7/vJcqd/DyijhC7bAkBRFIQQRhkAEEoBgDKGEOKcE0JoN8nznHPRb/4D1rObEKl5WRcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 8.9\"\n        title=\"Figure 8.9\"\n        src=\"/CR4-DL/static/fe42b8a2c6ae9dbd58a727a8625580e1/00d43/figure8-9.png\"\n        srcset=\"/CR4-DL/static/fe42b8a2c6ae9dbd58a727a8625580e1/63868/figure8-9.png 250w,\n/CR4-DL/static/fe42b8a2c6ae9dbd58a727a8625580e1/0b533/figure8-9.png 500w,\n/CR4-DL/static/fe42b8a2c6ae9dbd58a727a8625580e1/00d43/figure8-9.png 1000w,\n/CR4-DL/static/fe42b8a2c6ae9dbd58a727a8625580e1/f43e4/figure8-9.png 1120w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><em>Latent space</em>: the space that holds all possible abstractions obtained from the environment.</li>\n<li>Latent space is the same idea as the embedded space for words where certain directions encode certain features.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/fc7fa72ffeb0046fc161611a86a6b246/c2d9c/figure8-10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACyUlEQVQozwXB207aAAAA0H7PHpa9qNsMTgRioaUXoC2lQGlLKTcRqDhQbnIRREXm1OlUYmQaNdPExEWXZdmWLIuZif+xOFpRF5/QnQNcHDfPVtNny8mdnPfdOFsIUFmJHGWQiBMNOnGfAxdImEYMLhwUCJMsWGuyZ7caPV2vfN+qAl83pk9qoZOZYGuCXojSCRYZcyM+GyhgOg+qo40aQtcLvXyKaZ6RQz0+6HneDb6PkYeV0U+zMeB8d/7HWurLkrxTlOpRJuI0hxwmBhpww4M09MoOahiwHxvsceh7OWggZhmoetG1uKM1NXJUjQGXHxd/NgunS683C4FcmPIxZo4YtsNaBtY6kSEGGnRDGlLfJ4B9AbMmgfeXBXQxYl/LhFqFCPB7v/6tWT5eyayWormoW3LjHGVk8GHOAvJWo4APB0mjhGtjNm2CHp6gdRXJVgvZZ2PC8rgEnO8tnK1P79eTjXxEligfa2UsIGsDRcLkp+AwbU64ENlhyrqMJRHLu8CiaJvyWjMSMx10AZdHS6er+VZtrJqSRkWCc2EUrmesRidmEEnYR0AjDBJ3m9MeaCZMFlioLFpKApZmkWrQDlzs1Q9ro83SSCUhyBIV4G0uAmRtJsY8xOMGHtWHKCjO4pMcOiezOQ4u8mjeCY5ZBosuI/Brp9HKejemwhWZS4XoaIARHLDIoE5E50ENPGYI2aEET+QD1NuMvxKi5oJETUSzlK7OI8D+/GTeYyoFKZnD47wlItJeGhEdmAPWejCDB9X7SUgWyKREz00G06IlSevi6Atp4Mm4qQc4P9rcrSaOV8pbtfSHN1OttUajnKkXU/mYPxeVMmGuGJdmJqNLxcT2YmG7njloZA8buYNq8vNyEVCVtqoq/+7ubjodVVVubjq3t7fXnWtFVdpKW7lWFVX9224rinJ19ef+/v7x8bHbfeg+PHS7D/8B/L9Pa5TCcB0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 8.10\"\n        title=\"Figure 8.10\"\n        src=\"/CR4-DL/static/fc7fa72ffeb0046fc161611a86a6b246/00d43/figure8-10.png\"\n        srcset=\"/CR4-DL/static/fc7fa72ffeb0046fc161611a86a6b246/63868/figure8-10.png 250w,\n/CR4-DL/static/fc7fa72ffeb0046fc161611a86a6b246/0b533/figure8-10.png 500w,\n/CR4-DL/static/fc7fa72ffeb0046fc161611a86a6b246/00d43/figure8-10.png 1000w,\n/CR4-DL/static/fc7fa72ffeb0046fc161611a86a6b246/c2d9c/figure8-10.png 1326w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><em>Variational autoencoders (VAE)</em>: a variant of autoencoders that turns the input image into a mean and a variance.</li>\n<li>The three steps of VAE\n<ul>\n<li>Encode the image into two parameters in the latent space, a mean and a variance.</li>\n<li>Randomly sample a point from the latent space to generate the input image.</li>\n<li>Decode the point in latent space back into the original input image.</li>\n</ul>\n</li>\n<li><em>Generative adversarial networks (GAN)</em>: consists of two parts\n<ul>\n<li><em>Generator network</em>: takes a random vector as input and decodes it into a synthetic image.</li>\n<li><em>Discriminator network</em>: takes an image (real/synthetic) and predicts whether the image is real or synthetic.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/5611691222cefd1db3ba627e9d9dde00/cd78c/figure8-15.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5ElEQVQoz5WSTWvUQBjH81nE7+HBmyCIR08KouJFDyJiQUHEFloPBamCFUFa9VLQiyCIJ0E9iHSbZJNM0srS3SbszGQ3yc575pEku2qP/g7Dw8P8n5f/jAMAnPNJnk+nU601AFgLbVIwxjjnYgGlNM3SWUt30+nEKEKHh0NjDCwQQvyJbVsPY4pQYozRWiul5mIAKMuSMVbXtRSCEIoxGY2OMCYYk9msqq0VnO28WHl899L3L58BQEr5V1xVVVEUolEShOK9PbfvB72eG4YoTVMpFR5nS5dPXz1z4tP7LQCYTCbjMXa6FRlj3SRKaYwJIZQ0NCMwxgBAK/Vmc+3R0nX351cAoJSkWebYhUNam2ZsKevjaK0551LKbvO2gZob9u3D9o93Tz9urz9bvvH25XpblVKaU5rneXN2zllrhWj9F5wxNhffv3Ju8/b5exdPXTt7cuXWhaKskjgJgmh3t+e5/sHBrzTNlFJlWVLa7JJPGrp3cV5vrD5fvvPqycO1Bzd3tjasBUJo23PenzFmrTXGyBYhRNd27jYhdDQ6KqYF/CeOajGmFlJq03hmOnTzGcy/meNxIw7DMIqiwWAQhqHneQgh3/eDMAyCIEmSqA3iOEZR5Pl+sr+PUNTv913XHQ5HvwFDLJBc3gJQRAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 8.15\"\n        title=\"Figure 8.15\"\n        src=\"/CR4-DL/static/5611691222cefd1db3ba627e9d9dde00/00d43/figure8-15.png\"\n        srcset=\"/CR4-DL/static/5611691222cefd1db3ba627e9d9dde00/63868/figure8-15.png 250w,\n/CR4-DL/static/5611691222cefd1db3ba627e9d9dde00/0b533/figure8-15.png 500w,\n/CR4-DL/static/5611691222cefd1db3ba627e9d9dde00/00d43/figure8-15.png 1000w,\n/CR4-DL/static/5611691222cefd1db3ba627e9d9dde00/cd78c/figure8-15.png 1236w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>GANs don’t seek to minimize like SGD, but instead they seek to reach equilibrium.</li>\n<li>GANs are notoriously difficult to train.</li>\n<li>It’s important to freeze the discriminator’s weights while training the GAN. This way the discriminator won’t always predict “real”.</li>\n<li>Steps to train a GAN (per epoch)\n<ol>\n<li>Get random points from the latent space.</li>\n<li>Generate images using the random points and the <code class=\"language-text\">generator</code>.</li>\n<li>Mix the generated images with the real ones.</li>\n<li>Train the <code class=\"language-text\">discriminator</code> using the mixed images with corresponding targets (real/fake).</li>\n<li>Get new random points from the latent space.</li>\n<li>Train <code class=\"language-text\">gan</code> using these random points with targets that all say “real”. Freeze the discriminator’s weights and update the generator’s weights.</li>\n</ol>\n</li>\n</ul>\n<p><strong>Summary</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/fc2231e6a340d99c74f44e024cbe33a6/71b12/chapter8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5UlEQVQoz0VS2Y6jMBDM/3/dzBKuxNju9n1DEiB5WxlmZ6VSq12o+qjmkrNASYxjzoPS1Af47P69uffmPvtvtDU5yF/sq73kLAhtR9JwGMZ7jcFNKdClYPS0JAhumjPkyHNkKdAcWUkQPX3M4vLe3WczVo8Ke6tGLXqJvVGDs0SL3uqbloPETmJn9e0XSvQlwWVf7fo0SgyMNghd9PS5qGUWcxZLweci54Il42MWj0pCZTLmyF8PVcX7apeCSvTAGjZ9A2so+UJoJfaCt5w2wK4CWs6aSoqes2YiXznyKn5vriSoYn5FXj9rOTwX+SgiRz5nWIooCeaCc8b6nEXJ8Fr+dc6RMdpwfuW0UWJA3mo5WHPzlkQ/5chTYGcMjqTAvCNLwbOzTYHxYzYBnYAWeUunb2fu3k0pcm+Jq1VoCtXw4xzs/845cuTXqsROQHc43GNd+A/yFthVy3HOUNIPTl9/ds6JU/Itsefsivyq6sG6Y4pOHjlUvhXYVV+g9W46xW5dhDW3OqQlRo1KDtFTZ+7BTc7etRzq2Oam1ViLHghueszyvLMGVrud10fojBoPz0YlBmfu7ihqzc2a+/nbKDEsRVTx9jIpMGdJ8NWJYKfoqbckuClHtj719jJnPJKK7WX21fwFHXi8U0hD1IsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chapter 8\"\n        title=\"Chapter 8\"\n        src=\"/CR4-DL/static/fc2231e6a340d99c74f44e024cbe33a6/00d43/chapter8.png\"\n        srcset=\"/CR4-DL/static/fc2231e6a340d99c74f44e024cbe33a6/63868/chapter8.png 250w,\n/CR4-DL/static/fc2231e6a340d99c74f44e024cbe33a6/0b533/chapter8.png 500w,\n/CR4-DL/static/fc2231e6a340d99c74f44e024cbe33a6/00d43/chapter8.png 1000w,\n/CR4-DL/static/fc2231e6a340d99c74f44e024cbe33a6/71b12/chapter8.png 1308w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"chapter-9-conclusions\" style=\"position:relative;\"><a href=\"#chapter-9-conclusions\" aria-label=\"chapter 9 conclusions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chapter 9: Conclusions</h2>\n<ul>\n<li>A review on everything learnt in this textbook.</li>\n<li>Anything requiring reasoning is beyond deep learning.</li>\n<li>Neural networks doesn’t understand the task they perform.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/CR4-DL/static/dee9d59a2d228064fd976b7028b8a62b/01a87/figure9-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWklEQVQoz42Qy0rDQBiFsxHcuXchLvQd3PgCPoB7Nz6Jz9KVCt4QvFVQrKWiIjY0vaWYNmnazCQhl7lkZn5Jg1GEomczcOZ88/9nNISQYztxFHEufD/lTEgpORfwD2mTybTb64VhKCUEIZFCAQDj+SEVKACl5sMAUNymhMUJg5xRhHJQskj8AQMA5zzjrIwypXp+6KWECJmIuRW0cUKeJ4FUquNHJbxTf18/fdi8edq4buzWm3Phxhjvd2wA8On35O3a22LlaungduGwunxy14/Tos5v+Mx0s5lr+LGXssLdqr5olcu1i8fV89rK8b35A1ZfyuFplCQpIYRQShUUJhxZ7t6r0UJBGwVNHMxd27aGelNvtYzBYFD+rCDE6Xb6Rruj657j5KVmSuIYIeR5HsaYEKJxnjHGGKVZlpVPZlKiIHBc13bGKaUAgDEejYau61oflmmaCCORiU/fvTHsgD3wCAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 9.4\"\n        title=\"Figure 9.4\"\n        src=\"/CR4-DL/static/dee9d59a2d228064fd976b7028b8a62b/00d43/figure9-4.png\"\n        srcset=\"/CR4-DL/static/dee9d59a2d228064fd976b7028b8a62b/63868/figure9-4.png 250w,\n/CR4-DL/static/dee9d59a2d228064fd976b7028b8a62b/0b533/figure9-4.png 500w,\n/CR4-DL/static/dee9d59a2d228064fd976b7028b8a62b/00d43/figure9-4.png 1000w,\n/CR4-DL/static/dee9d59a2d228064fd976b7028b8a62b/01a87/figure9-4.png 1288w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>The only real success of deep learning so far has been the ability to map space X to space Y using a continuous geometric transform, given large amounts of human-annotated data.</li>\n<li>To make something more efficient, there’s one universal recipe: introduce modularity and hierarchy.</li>\n<li>So please go on learning, questioning, and researching.</li>\n<li>Never stop. Because even given the progress made so far, most of the fundamental questions in AI remain unanswered. Many haven’t even been properly asked yet.</li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#part-i-fundamentals-of-deep-learning\">Part I: Fundamentals of Deep Learning</a></p>\n<ul>\n<li><a href=\"#chapter-1-what-is-deep-learning\">Chapter 1: What is deep learning?</a></li>\n<li><a href=\"#chapter-2-before-we-begin-the-mathematical-building-blocks-of-neural-networks\">Chapter 2: Before we begin: the mathematical building blocks of neural networks</a></li>\n<li><a href=\"#chapter-3-getting-started-with-neural-networks\">Chapter 3: Getting started with neural networks</a></li>\n<li><a href=\"#chapter-4-fundamentals-of-machine-learning\">Chapter 4: Fundamentals of machine learning</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#part-ii-deep-learning-in-practice\">Part II: Deep Learning in Practice</a></p>\n<ul>\n<li><a href=\"#chapter-5-deep-learning-for-computer-vision\">Chapter 5: Deep learning for computer vision</a></li>\n<li><a href=\"#chapter-6-deep-learning-for-text-and-sequences\">Chapter 6: Deep learning for text and sequences</a></li>\n<li><a href=\"#chapter-7-advanced-deep-learning-best-practices\">Chapter 7: Advanced deep-learning best practices</a></li>\n<li><a href=\"#chapter-8-generative-deep-learning\">Chapter 8: Generative deep learning</a></li>\n<li><a href=\"#chapter-9-conclusions\">Chapter 9: Conclusions</a></li>\n</ul>\n</li>\n</ul>","timeToRead":43,"frontmatter":{"title":"Deep Learning with Python","date":"June 02, 2019","book_authors":"François Chollet","categories":["Textbooks"]}}},"pageContext":{"slug":"/textbooks/deep-learning-with-python/","previous":{"fields":{"slug":"/books/the-human-advantage/"},"frontmatter":{"title":"The Human Advantage","layout":"post"}},"next":{"fields":{"slug":"/books/connectome/"},"frontmatter":{"title":"Connectome","layout":"post"}}}},
    "staticQueryHashes": ["1031357278","1878747374","3666494887"]}